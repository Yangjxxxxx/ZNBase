# LogicTest: local local-opt

statement ok
CREATE DATABASE a

statement ok
GRANT USAGE ON DATABASE a TO public

statement ok
CREATE USER readwrite

statement ok
GRANT ALL ON DATABASE a TO readwrite

query TTTTT colnames
SHOW GRANTS ON DATABASE a
----
database_name  grantor  grantee    privilege_type  grantable
a              admin    admin      CREATE          YES
a              admin    admin      DROP            YES
a              admin    admin      USAGE           YES
a              admin    root       CREATE          YES
a              admin    root       DROP            YES
a              admin    root       USAGE           YES
a              root     public     USAGE           NO
a              root     readwrite  CREATE          NO
a              root     readwrite  DROP            NO
a              root     readwrite  USAGE           NO

# Show that by default GRANT is restricted to the current database
query TTTTTTTT colnames
SHOW GRANTS
----
database_name  schema_name         relation_name                      column_name  grantor  grantee  privilege_type  grantable
test           NULL                NULL                               NULL         admin    admin    CREATE          YES
test           NULL                NULL                               NULL         admin    admin    DROP            YES
test           NULL                NULL                               NULL         admin    admin    USAGE           YES
test           NULL                NULL                               NULL         admin    root     CREATE          YES
test           NULL                NULL                               NULL         admin    root     DROP            YES
test           NULL                NULL                               NULL         admin    root     USAGE           YES
test           information_schema  NULL                               NULL         admin    admin    CREATE          YES
test           information_schema  NULL                               NULL         admin    admin    DROP            YES
test           information_schema  NULL                               NULL         admin    admin    USAGE           YES
test           information_schema  NULL                               NULL         admin    root     CREATE          YES
test           information_schema  NULL                               NULL         admin    root     DROP            YES
test           information_schema  NULL                               NULL         admin    root     USAGE           YES
test           information_schema  administrable_role_authorizations  NULL         admin    public   SELECT          NO
test           information_schema  applicable_roles                   NULL         admin    public   SELECT          NO
test           information_schema  check_constraints                  NULL         admin    public   SELECT          NO
test           information_schema  column_privileges                  NULL         admin    public   SELECT          NO
test           information_schema  columns                            NULL         admin    public   SELECT          NO
test           information_schema  constraint_column_usage            NULL         admin    public   SELECT          NO
test           information_schema  database_privileges                NULL         admin    public   SELECT          NO
test           information_schema  enabled_roles                      NULL         admin    public   SELECT          NO
test           information_schema  functions                          NULL         admin    public   SELECT          NO
test           information_schema  index_partition                    NULL         admin    public   SELECT          NO
test           information_schema  key_column_usage                   NULL         admin    public   SELECT          NO
test           information_schema  parameters                         NULL         admin    public   SELECT          NO
test           information_schema  referential_constraints            NULL         admin    public   SELECT          NO
test           information_schema  role_table_grants                  NULL         admin    public   SELECT          NO
test           information_schema  routines                           NULL         admin    public   SELECT          NO
test           information_schema  schema_privileges                  NULL         admin    public   SELECT          NO
test           information_schema  schemata                           NULL         admin    public   SELECT          NO
test           information_schema  sequences                          NULL         admin    public   SELECT          NO
test           information_schema  statistics                         NULL         admin    public   SELECT          NO
test           information_schema  table_constraints                  NULL         admin    public   SELECT          NO
test           information_schema  table_privileges                   NULL         admin    public   SELECT          NO
test           information_schema  tables                             NULL         admin    public   SELECT          NO
test           information_schema  trigger_privileges                 NULL         admin    public   SELECT          NO
test           information_schema  user_privileges                    NULL         admin    public   SELECT          NO
test           information_schema  views                              NULL         admin    public   SELECT          NO
test           pg_catalog          NULL                               NULL         admin    admin    CREATE          YES
test           pg_catalog          NULL                               NULL         admin    admin    DROP            YES
test           pg_catalog          NULL                               NULL         admin    admin    USAGE           YES
test           pg_catalog          NULL                               NULL         admin    root     CREATE          YES
test           pg_catalog          NULL                               NULL         admin    root     DROP            YES
test           pg_catalog          NULL                               NULL         admin    root     USAGE           YES
test           pg_catalog          pg_am                              NULL         admin    public   SELECT          NO
test           pg_catalog          pg_attrdef                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_attribute                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_auth_members                    NULL         admin    public   SELECT          NO
test           pg_catalog          pg_class                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_collation                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_constraint                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_database                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_depend                          NULL         admin    public   SELECT          NO
test           pg_catalog          pg_description                     NULL         admin    public   SELECT          NO
test           pg_catalog          pg_enum                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_extension                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_data_wrapper            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_server                  NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_table                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_index                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_indexes                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_inherits                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_language                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_namespace                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_nodestatus                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_operator                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_proc                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_range                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_rewrite                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_roles                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_seclabel                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_sequence                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_settings                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_shdescription                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_shseclabel                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_stat_activity                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_tables                          NULL         admin    public   SELECT          NO
test           pg_catalog          pg_tablespace                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_trigger                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_type                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_user                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_user_mapping                    NULL         admin    public   SELECT          NO
test           pg_catalog          pg_views                           NULL         admin    public   SELECT          NO
test           public              NULL                               NULL         admin    admin    CREATE          YES
test           public              NULL                               NULL         admin    admin    DROP            YES
test           public              NULL                               NULL         admin    admin    USAGE           YES
test           public              NULL                               NULL         admin    root     CREATE          YES
test           public              NULL                               NULL         admin    root     DROP            YES
test           public              NULL                               NULL         admin    root     USAGE           YES
test           public              NULL                               NULL         root     public   USAGE           NO
test           zbdb_internal       NULL                               NULL         admin    admin    CREATE          YES
test           zbdb_internal       NULL                               NULL         admin    admin    DROP            YES
test           zbdb_internal       NULL                               NULL         admin    admin    USAGE           YES
test           zbdb_internal       NULL                               NULL         admin    root     CREATE          YES
test           zbdb_internal       NULL                               NULL         admin    root     DROP            YES
test           zbdb_internal       NULL                               NULL         admin    root     USAGE           YES
test           zbdb_internal       backward_dependencies              NULL         admin    public   SELECT          NO
test           zbdb_internal       builtin_functions                  NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_queries                    NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_sessions                   NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_settings                   NULL         admin    public   SELECT          NO
test           zbdb_internal       create_statements                  NULL         admin    public   SELECT          NO
test           zbdb_internal       databases                          NULL         admin    public   SELECT          NO
test           zbdb_internal       feature_usage                      NULL         admin    public   SELECT          NO
test           zbdb_internal       forward_dependencies               NULL         admin    public   SELECT          NO
test           zbdb_internal       function_privileges                NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_alerts                      NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_liveness                    NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_network                     NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_nodes                       NULL         admin    public   SELECT          NO
test           zbdb_internal       index_columns                      NULL         admin    public   SELECT          NO
test           zbdb_internal       jobs                               NULL         admin    public   SELECT          NO
test           zbdb_internal       kv_node_status                     NULL         admin    public   SELECT          NO
test           zbdb_internal       kv_store_status                    NULL         admin    public   SELECT          NO
test           zbdb_internal       leases                             NULL         admin    public   SELECT          NO
test           zbdb_internal       node_build_info                    NULL         admin    public   SELECT          NO
test           zbdb_internal       node_metrics                       NULL         admin    public   SELECT          NO
test           zbdb_internal       node_queries                       NULL         admin    public   SELECT          NO
test           zbdb_internal       node_runtime_info                  NULL         admin    public   SELECT          NO
test           zbdb_internal       node_sessions                      NULL         admin    public   SELECT          NO
test           zbdb_internal       node_statement_statistics          NULL         admin    public   SELECT          NO
test           zbdb_internal       partition_views                    NULL         admin    public   SELECT          NO
test           zbdb_internal       partitions                         NULL         admin    public   SELECT          NO
test           zbdb_internal       predefined_comments                NULL         admin    public   SELECT          NO
test           zbdb_internal       ranges                             NULL         admin    public   SELECT          NO
test           zbdb_internal       ranges_no_leases                   NULL         admin    public   SELECT          NO
test           zbdb_internal       savepoint_status                   NULL         admin    public   SELECT          NO
test           zbdb_internal       schema_changes                     NULL         admin    public   SELECT          NO
test           zbdb_internal       session_trace                      NULL         admin    public   SELECT          NO
test           zbdb_internal       session_variables                  NULL         admin    public   SELECT          NO
test           zbdb_internal       table_columns                      NULL         admin    public   SELECT          NO
test           zbdb_internal       table_indexes                      NULL         admin    public   SELECT          NO
test           zbdb_internal       table_row_statistics               NULL         admin    public   SELECT          NO
test           zbdb_internal       tables                             NULL         admin    public   SELECT          NO
test           zbdb_internal       zones                              NULL         admin    public   SELECT          NO

query TTTTTTTT colnames
SHOW GRANTS FOR root
----
database_name  schema_name         relation_name                      column_name  grantor  grantee  privilege_type  grantable
test           NULL                NULL                               NULL         admin    admin    CREATE          YES
test           NULL                NULL                               NULL         admin    admin    DROP            YES
test           NULL                NULL                               NULL         admin    admin    USAGE           YES
test           NULL                NULL                               NULL         admin    root     CREATE          YES
test           NULL                NULL                               NULL         admin    root     DROP            YES
test           NULL                NULL                               NULL         admin    root     USAGE           YES
test           information_schema  NULL                               NULL         admin    admin    CREATE          YES
test           information_schema  NULL                               NULL         admin    admin    DROP            YES
test           information_schema  NULL                               NULL         admin    admin    USAGE           YES
test           information_schema  NULL                               NULL         admin    root     CREATE          YES
test           information_schema  NULL                               NULL         admin    root     DROP            YES
test           information_schema  NULL                               NULL         admin    root     USAGE           YES
test           information_schema  administrable_role_authorizations  NULL         admin    public   SELECT          NO
test           information_schema  applicable_roles                   NULL         admin    public   SELECT          NO
test           information_schema  check_constraints                  NULL         admin    public   SELECT          NO
test           information_schema  column_privileges                  NULL         admin    public   SELECT          NO
test           information_schema  columns                            NULL         admin    public   SELECT          NO
test           information_schema  constraint_column_usage            NULL         admin    public   SELECT          NO
test           information_schema  database_privileges                NULL         admin    public   SELECT          NO
test           information_schema  enabled_roles                      NULL         admin    public   SELECT          NO
test           information_schema  functions                          NULL         admin    public   SELECT          NO
test           information_schema  index_partition                    NULL         admin    public   SELECT          NO
test           information_schema  key_column_usage                   NULL         admin    public   SELECT          NO
test           information_schema  parameters                         NULL         admin    public   SELECT          NO
test           information_schema  referential_constraints            NULL         admin    public   SELECT          NO
test           information_schema  role_table_grants                  NULL         admin    public   SELECT          NO
test           information_schema  routines                           NULL         admin    public   SELECT          NO
test           information_schema  schema_privileges                  NULL         admin    public   SELECT          NO
test           information_schema  schemata                           NULL         admin    public   SELECT          NO
test           information_schema  sequences                          NULL         admin    public   SELECT          NO
test           information_schema  statistics                         NULL         admin    public   SELECT          NO
test           information_schema  table_constraints                  NULL         admin    public   SELECT          NO
test           information_schema  table_privileges                   NULL         admin    public   SELECT          NO
test           information_schema  tables                             NULL         admin    public   SELECT          NO
test           information_schema  trigger_privileges                 NULL         admin    public   SELECT          NO
test           information_schema  user_privileges                    NULL         admin    public   SELECT          NO
test           information_schema  views                              NULL         admin    public   SELECT          NO
test           pg_catalog          NULL                               NULL         admin    admin    CREATE          YES
test           pg_catalog          NULL                               NULL         admin    admin    DROP            YES
test           pg_catalog          NULL                               NULL         admin    admin    USAGE           YES
test           pg_catalog          NULL                               NULL         admin    root     CREATE          YES
test           pg_catalog          NULL                               NULL         admin    root     DROP            YES
test           pg_catalog          NULL                               NULL         admin    root     USAGE           YES
test           pg_catalog          pg_am                              NULL         admin    public   SELECT          NO
test           pg_catalog          pg_attrdef                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_attribute                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_auth_members                    NULL         admin    public   SELECT          NO
test           pg_catalog          pg_class                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_collation                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_constraint                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_database                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_depend                          NULL         admin    public   SELECT          NO
test           pg_catalog          pg_description                     NULL         admin    public   SELECT          NO
test           pg_catalog          pg_enum                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_extension                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_data_wrapper            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_server                  NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_table                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_index                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_indexes                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_inherits                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_language                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_namespace                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_nodestatus                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_operator                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_proc                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_range                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_rewrite                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_roles                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_seclabel                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_sequence                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_settings                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_shdescription                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_shseclabel                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_stat_activity                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_tables                          NULL         admin    public   SELECT          NO
test           pg_catalog          pg_tablespace                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_trigger                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_type                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_user                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_user_mapping                    NULL         admin    public   SELECT          NO
test           pg_catalog          pg_views                           NULL         admin    public   SELECT          NO
test           public              NULL                               NULL         admin    admin    CREATE          YES
test           public              NULL                               NULL         admin    admin    DROP            YES
test           public              NULL                               NULL         admin    admin    USAGE           YES
test           public              NULL                               NULL         admin    root     CREATE          YES
test           public              NULL                               NULL         admin    root     DROP            YES
test           public              NULL                               NULL         admin    root     USAGE           YES
test           public              NULL                               NULL         root     public   USAGE           NO
test           zbdb_internal       NULL                               NULL         admin    admin    CREATE          YES
test           zbdb_internal       NULL                               NULL         admin    admin    DROP            YES
test           zbdb_internal       NULL                               NULL         admin    admin    USAGE           YES
test           zbdb_internal       NULL                               NULL         admin    root     CREATE          YES
test           zbdb_internal       NULL                               NULL         admin    root     DROP            YES
test           zbdb_internal       NULL                               NULL         admin    root     USAGE           YES
test           zbdb_internal       backward_dependencies              NULL         admin    public   SELECT          NO
test           zbdb_internal       builtin_functions                  NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_queries                    NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_sessions                   NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_settings                   NULL         admin    public   SELECT          NO
test           zbdb_internal       create_statements                  NULL         admin    public   SELECT          NO
test           zbdb_internal       databases                          NULL         admin    public   SELECT          NO
test           zbdb_internal       feature_usage                      NULL         admin    public   SELECT          NO
test           zbdb_internal       forward_dependencies               NULL         admin    public   SELECT          NO
test           zbdb_internal       function_privileges                NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_alerts                      NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_liveness                    NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_network                     NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_nodes                       NULL         admin    public   SELECT          NO
test           zbdb_internal       index_columns                      NULL         admin    public   SELECT          NO
test           zbdb_internal       jobs                               NULL         admin    public   SELECT          NO
test           zbdb_internal       kv_node_status                     NULL         admin    public   SELECT          NO
test           zbdb_internal       kv_store_status                    NULL         admin    public   SELECT          NO
test           zbdb_internal       leases                             NULL         admin    public   SELECT          NO
test           zbdb_internal       node_build_info                    NULL         admin    public   SELECT          NO
test           zbdb_internal       node_metrics                       NULL         admin    public   SELECT          NO
test           zbdb_internal       node_queries                       NULL         admin    public   SELECT          NO
test           zbdb_internal       node_runtime_info                  NULL         admin    public   SELECT          NO
test           zbdb_internal       node_sessions                      NULL         admin    public   SELECT          NO
test           zbdb_internal       node_statement_statistics          NULL         admin    public   SELECT          NO
test           zbdb_internal       partition_views                    NULL         admin    public   SELECT          NO
test           zbdb_internal       partitions                         NULL         admin    public   SELECT          NO
test           zbdb_internal       predefined_comments                NULL         admin    public   SELECT          NO
test           zbdb_internal       ranges                             NULL         admin    public   SELECT          NO
test           zbdb_internal       ranges_no_leases                   NULL         admin    public   SELECT          NO
test           zbdb_internal       savepoint_status                   NULL         admin    public   SELECT          NO
test           zbdb_internal       schema_changes                     NULL         admin    public   SELECT          NO
test           zbdb_internal       session_trace                      NULL         admin    public   SELECT          NO
test           zbdb_internal       session_variables                  NULL         admin    public   SELECT          NO
test           zbdb_internal       table_columns                      NULL         admin    public   SELECT          NO
test           zbdb_internal       table_indexes                      NULL         admin    public   SELECT          NO
test           zbdb_internal       table_row_statistics               NULL         admin    public   SELECT          NO
test           zbdb_internal       tables                             NULL         admin    public   SELECT          NO
test           zbdb_internal       zones                              NULL         admin    public   SELECT          NO

# With no database set, we show the grants everywhere
statement ok
SET DATABASE = ''

query TTTTTTTT colnames
SELECT * FROM [SHOW GRANTS]
WHERE schema_name NOT IN ('zbdb_internal', 'pg_catalog', 'information_schema')
----
database_name  schema_name  relation_name       column_name  grantor  grantee  privilege_type  grantable
a              public       NULL                NULL         admin    admin    CREATE          YES
a              public       NULL                NULL         admin    admin    DROP            YES
a              public       NULL                NULL         admin    admin    USAGE           YES
a              public       NULL                NULL         admin    root     CREATE          YES
a              public       NULL                NULL         admin    root     DROP            YES
a              public       NULL                NULL         admin    root     USAGE           YES
a              public       NULL                NULL         root     public   USAGE           NO
defaultdb      public       NULL                NULL         admin    admin    CREATE          YES
defaultdb      public       NULL                NULL         admin    admin    DROP            YES
defaultdb      public       NULL                NULL         admin    admin    USAGE           YES
defaultdb      public       NULL                NULL         admin    root     CREATE          YES
defaultdb      public       NULL                NULL         admin    root     DROP            YES
defaultdb      public       NULL                NULL         admin    root     USAGE           YES
defaultdb      public       NULL                NULL         root     public   USAGE           NO
postgres       public       NULL                NULL         admin    admin    CREATE          YES
postgres       public       NULL                NULL         admin    admin    DROP            YES
postgres       public       NULL                NULL         admin    admin    USAGE           YES
postgres       public       NULL                NULL         admin    root     CREATE          YES
postgres       public       NULL                NULL         admin    root     DROP            YES
postgres       public       NULL                NULL         admin    root     USAGE           YES
system         public       NULL                NULL         admin    admin    USAGE           YES
system         public       NULL                NULL         admin    root     USAGE           YES
system         public       authentication      NULL         admin    admin    DELETE          YES
system         public       authentication      NULL         admin    admin    INSERT          YES
system         public       authentication      NULL         admin    admin    SELECT          YES
system         public       authentication      NULL         admin    admin    UPDATE          YES
system         public       authentication      NULL         admin    root     DELETE          YES
system         public       authentication      NULL         admin    root     INSERT          YES
system         public       authentication      NULL         admin    root     SELECT          YES
system         public       authentication      NULL         admin    root     UPDATE          YES
system         public       comments            NULL         admin    admin    DELETE          YES
system         public       comments            NULL         admin    admin    INSERT          YES
system         public       comments            NULL         admin    admin    SELECT          YES
system         public       comments            NULL         admin    admin    UPDATE          YES
system         public       comments            NULL         admin    public   DELETE          YES
system         public       comments            NULL         admin    public   INSERT          YES
system         public       comments            NULL         admin    public   SELECT          YES
system         public       comments            NULL         admin    public   UPDATE          YES
system         public       comments            NULL         admin    root     DELETE          YES
system         public       comments            NULL         admin    root     INSERT          YES
system         public       comments            NULL         admin    root     SELECT          YES
system         public       comments            NULL         admin    root     UPDATE          YES
system         public       descriptor          NULL         admin    admin    SELECT          YES
system         public       descriptor          NULL         admin    root     SELECT          YES
system         public       eventlog            NULL         admin    admin    DELETE          YES
system         public       eventlog            NULL         admin    admin    INSERT          YES
system         public       eventlog            NULL         admin    admin    SELECT          YES
system         public       eventlog            NULL         admin    admin    UPDATE          YES
system         public       eventlog            NULL         admin    root     DELETE          YES
system         public       eventlog            NULL         admin    root     INSERT          YES
system         public       eventlog            NULL         admin    root     SELECT          YES
system         public       eventlog            NULL         admin    root     UPDATE          YES
system         public       flashback           NULL         admin    admin    DELETE          YES
system         public       flashback           NULL         admin    admin    INSERT          YES
system         public       flashback           NULL         admin    admin    SELECT          YES
system         public       flashback           NULL         admin    admin    UPDATE          YES
system         public       flashback           NULL         admin    public   DELETE          YES
system         public       flashback           NULL         admin    public   INSERT          YES
system         public       flashback           NULL         admin    public   SELECT          YES
system         public       flashback           NULL         admin    public   UPDATE          YES
system         public       flashback           NULL         admin    root     DELETE          YES
system         public       flashback           NULL         admin    root     INSERT          YES
system         public       flashback           NULL         admin    root     SELECT          YES
system         public       flashback           NULL         admin    root     UPDATE          YES
system         public       function_namespace  NULL         admin    admin    SELECT          YES
system         public       function_namespace  NULL         admin    root     SELECT          YES
system         public       hints               NULL         admin    admin    DELETE          YES
system         public       hints               NULL         admin    admin    INSERT          YES
system         public       hints               NULL         admin    admin    SELECT          YES
system         public       hints               NULL         admin    admin    UPDATE          YES
system         public       hints               NULL         admin    root     DELETE          YES
system         public       hints               NULL         admin    root     INSERT          YES
system         public       hints               NULL         admin    root     SELECT          YES
system         public       hints               NULL         admin    root     UPDATE          YES
system         public       jobs                NULL         admin    admin    DELETE          YES
system         public       jobs                NULL         admin    admin    INSERT          YES
system         public       jobs                NULL         admin    admin    SELECT          YES
system         public       jobs                NULL         admin    admin    UPDATE          YES
system         public       jobs                NULL         admin    root     DELETE          YES
system         public       jobs                NULL         admin    root     INSERT          YES
system         public       jobs                NULL         admin    root     SELECT          YES
system         public       jobs                NULL         admin    root     UPDATE          YES
system         public       lease               NULL         admin    admin    DELETE          YES
system         public       lease               NULL         admin    admin    INSERT          YES
system         public       lease               NULL         admin    admin    SELECT          YES
system         public       lease               NULL         admin    admin    UPDATE          YES
system         public       lease               NULL         admin    root     DELETE          YES
system         public       lease               NULL         admin    root     INSERT          YES
system         public       lease               NULL         admin    root     SELECT          YES
system         public       lease               NULL         admin    root     UPDATE          YES
system         public       location            NULL         admin    admin    DELETE          YES
system         public       location            NULL         admin    admin    INSERT          YES
system         public       location            NULL         admin    admin    SELECT          YES
system         public       location            NULL         admin    admin    UPDATE          YES
system         public       location            NULL         admin    root     DELETE          YES
system         public       location            NULL         admin    root     INSERT          YES
system         public       location            NULL         admin    root     SELECT          YES
system         public       location            NULL         admin    root     UPDATE          YES
system         public       locations           NULL         admin    admin    DELETE          YES
system         public       locations           NULL         admin    admin    INSERT          YES
system         public       locations           NULL         admin    admin    SELECT          YES
system         public       locations           NULL         admin    admin    UPDATE          YES
system         public       locations           NULL         admin    root     DELETE          YES
system         public       locations           NULL         admin    root     INSERT          YES
system         public       locations           NULL         admin    root     SELECT          YES
system         public       locations           NULL         admin    root     UPDATE          YES
system         public       namespace           NULL         admin    admin    SELECT          YES
system         public       namespace           NULL         admin    root     SELECT          YES
system         public       rangelog            NULL         admin    admin    DELETE          YES
system         public       rangelog            NULL         admin    admin    INSERT          YES
system         public       rangelog            NULL         admin    admin    SELECT          YES
system         public       rangelog            NULL         admin    admin    UPDATE          YES
system         public       rangelog            NULL         admin    root     DELETE          YES
system         public       rangelog            NULL         admin    root     INSERT          YES
system         public       rangelog            NULL         admin    root     SELECT          YES
system         public       rangelog            NULL         admin    root     UPDATE          YES
system         public       role_members        NULL         admin    admin    DELETE          YES
system         public       role_members        NULL         admin    admin    INSERT          YES
system         public       role_members        NULL         admin    admin    SELECT          YES
system         public       role_members        NULL         admin    admin    UPDATE          YES
system         public       role_members        NULL         admin    root     DELETE          YES
system         public       role_members        NULL         admin    root     INSERT          YES
system         public       role_members        NULL         admin    root     SELECT          YES
system         public       role_members        NULL         admin    root     UPDATE          YES
system         public       scheduled_jobs      NULL         admin    admin    DELETE          YES
system         public       scheduled_jobs      NULL         admin    admin    INSERT          YES
system         public       scheduled_jobs      NULL         admin    admin    SELECT          YES
system         public       scheduled_jobs      NULL         admin    admin    UPDATE          YES
system         public       scheduled_jobs      NULL         admin    root     DELETE          YES
system         public       scheduled_jobs      NULL         admin    root     INSERT          YES
system         public       scheduled_jobs      NULL         admin    root     SELECT          YES
system         public       scheduled_jobs      NULL         admin    root     UPDATE          YES
system         public       settings            NULL         admin    admin    DELETE          YES
system         public       settings            NULL         admin    admin    INSERT          YES
system         public       settings            NULL         admin    admin    SELECT          YES
system         public       settings            NULL         admin    admin    UPDATE          YES
system         public       settings            NULL         admin    root     DELETE          YES
system         public       settings            NULL         admin    root     INSERT          YES
system         public       settings            NULL         admin    root     SELECT          YES
system         public       settings            NULL         admin    root     UPDATE          YES
system         public       snapshots           NULL         admin    admin    DELETE          YES
system         public       snapshots           NULL         admin    admin    INSERT          YES
system         public       snapshots           NULL         admin    admin    SELECT          YES
system         public       snapshots           NULL         admin    admin    UPDATE          YES
system         public       snapshots           NULL         admin    public   DELETE          YES
system         public       snapshots           NULL         admin    public   INSERT          YES
system         public       snapshots           NULL         admin    public   SELECT          YES
system         public       snapshots           NULL         admin    public   UPDATE          YES
system         public       snapshots           NULL         admin    root     DELETE          YES
system         public       snapshots           NULL         admin    root     INSERT          YES
system         public       snapshots           NULL         admin    root     SELECT          YES
system         public       snapshots           NULL         admin    root     UPDATE          YES
system         public       table_statistics    NULL         admin    admin    DELETE          YES
system         public       table_statistics    NULL         admin    admin    INSERT          YES
system         public       table_statistics    NULL         admin    admin    SELECT          YES
system         public       table_statistics    NULL         admin    admin    UPDATE          YES
system         public       table_statistics    NULL         admin    root     DELETE          YES
system         public       table_statistics    NULL         admin    root     INSERT          YES
system         public       table_statistics    NULL         admin    root     SELECT          YES
system         public       table_statistics    NULL         admin    root     UPDATE          YES
system         public       triggers            NULL         admin    admin    DELETE          YES
system         public       triggers            NULL         admin    admin    INSERT          YES
system         public       triggers            NULL         admin    admin    SELECT          YES
system         public       triggers            NULL         admin    admin    UPDATE          YES
system         public       triggers            NULL         admin    root     DELETE          YES
system         public       triggers            NULL         admin    root     INSERT          YES
system         public       triggers            NULL         admin    root     SELECT          YES
system         public       triggers            NULL         admin    root     UPDATE          YES
system         public       ui                  NULL         admin    admin    DELETE          YES
system         public       ui                  NULL         admin    admin    INSERT          YES
system         public       ui                  NULL         admin    admin    SELECT          YES
system         public       ui                  NULL         admin    admin    UPDATE          YES
system         public       ui                  NULL         admin    root     DELETE          YES
system         public       ui                  NULL         admin    root     INSERT          YES
system         public       ui                  NULL         admin    root     SELECT          YES
system         public       ui                  NULL         admin    root     UPDATE          YES
system         public       user_options        NULL         admin    admin    DELETE          YES
system         public       user_options        NULL         admin    admin    INSERT          YES
system         public       user_options        NULL         admin    admin    SELECT          YES
system         public       user_options        NULL         admin    admin    UPDATE          YES
system         public       user_options        NULL         admin    root     DELETE          YES
system         public       user_options        NULL         admin    root     INSERT          YES
system         public       user_options        NULL         admin    root     SELECT          YES
system         public       user_options        NULL         admin    root     UPDATE          YES
system         public       users               NULL         admin    admin    DELETE          YES
system         public       users               NULL         admin    admin    INSERT          YES
system         public       users               NULL         admin    admin    SELECT          YES
system         public       users               NULL         admin    admin    UPDATE          YES
system         public       users               NULL         admin    root     DELETE          YES
system         public       users               NULL         admin    root     INSERT          YES
system         public       users               NULL         admin    root     SELECT          YES
system         public       users               NULL         admin    root     UPDATE          YES
system         public       web_sessions        NULL         admin    admin    DELETE          YES
system         public       web_sessions        NULL         admin    admin    INSERT          YES
system         public       web_sessions        NULL         admin    admin    SELECT          YES
system         public       web_sessions        NULL         admin    admin    UPDATE          YES
system         public       web_sessions        NULL         admin    root     DELETE          YES
system         public       web_sessions        NULL         admin    root     INSERT          YES
system         public       web_sessions        NULL         admin    root     SELECT          YES
system         public       web_sessions        NULL         admin    root     UPDATE          YES
system         public       zones               NULL         admin    admin    DELETE          YES
system         public       zones               NULL         admin    admin    INSERT          YES
system         public       zones               NULL         admin    admin    SELECT          YES
system         public       zones               NULL         admin    admin    UPDATE          YES
system         public       zones               NULL         admin    root     DELETE          YES
system         public       zones               NULL         admin    root     INSERT          YES
system         public       zones               NULL         admin    root     SELECT          YES
system         public       zones               NULL         admin    root     UPDATE          YES
test           public       NULL                NULL         admin    admin    CREATE          YES
test           public       NULL                NULL         admin    admin    DROP            YES
test           public       NULL                NULL         admin    admin    USAGE           YES
test           public       NULL                NULL         admin    root     CREATE          YES
test           public       NULL                NULL         admin    root     DROP            YES
test           public       NULL                NULL         admin    root     USAGE           YES
test           public       NULL                NULL         root     public   USAGE           NO

query TTTTTTTT colnames
SHOW GRANTS FOR root
----
database_name  schema_name         relation_name                      column_name  grantor  grantee  privilege_type  grantable
a              NULL                NULL                               NULL         admin    admin    CREATE          YES
a              NULL                NULL                               NULL         admin    admin    DROP            YES
a              NULL                NULL                               NULL         admin    admin    USAGE           YES
a              NULL                NULL                               NULL         admin    root     CREATE          YES
a              NULL                NULL                               NULL         admin    root     DROP            YES
a              NULL                NULL                               NULL         admin    root     USAGE           YES
a              NULL                NULL                               NULL         root     public   USAGE           NO
a              information_schema  NULL                               NULL         admin    admin    CREATE          YES
a              information_schema  NULL                               NULL         admin    admin    DROP            YES
a              information_schema  NULL                               NULL         admin    admin    USAGE           YES
a              information_schema  NULL                               NULL         admin    root     CREATE          YES
a              information_schema  NULL                               NULL         admin    root     DROP            YES
a              information_schema  NULL                               NULL         admin    root     USAGE           YES
a              information_schema  NULL                               NULL         root     public   USAGE           NO
a              information_schema  administrable_role_authorizations  NULL         admin    public   SELECT          NO
a              information_schema  applicable_roles                   NULL         admin    public   SELECT          NO
a              information_schema  check_constraints                  NULL         admin    public   SELECT          NO
a              information_schema  column_privileges                  NULL         admin    public   SELECT          NO
a              information_schema  columns                            NULL         admin    public   SELECT          NO
a              information_schema  constraint_column_usage            NULL         admin    public   SELECT          NO
a              information_schema  database_privileges                NULL         admin    public   SELECT          NO
a              information_schema  enabled_roles                      NULL         admin    public   SELECT          NO
a              information_schema  functions                          NULL         admin    public   SELECT          NO
a              information_schema  index_partition                    NULL         admin    public   SELECT          NO
a              information_schema  key_column_usage                   NULL         admin    public   SELECT          NO
a              information_schema  parameters                         NULL         admin    public   SELECT          NO
a              information_schema  referential_constraints            NULL         admin    public   SELECT          NO
a              information_schema  role_table_grants                  NULL         admin    public   SELECT          NO
a              information_schema  routines                           NULL         admin    public   SELECT          NO
a              information_schema  schema_privileges                  NULL         admin    public   SELECT          NO
a              information_schema  schemata                           NULL         admin    public   SELECT          NO
a              information_schema  sequences                          NULL         admin    public   SELECT          NO
a              information_schema  statistics                         NULL         admin    public   SELECT          NO
a              information_schema  table_constraints                  NULL         admin    public   SELECT          NO
a              information_schema  table_privileges                   NULL         admin    public   SELECT          NO
a              information_schema  tables                             NULL         admin    public   SELECT          NO
a              information_schema  trigger_privileges                 NULL         admin    public   SELECT          NO
a              information_schema  user_privileges                    NULL         admin    public   SELECT          NO
a              information_schema  views                              NULL         admin    public   SELECT          NO
a              pg_catalog          NULL                               NULL         admin    admin    CREATE          YES
a              pg_catalog          NULL                               NULL         admin    admin    DROP            YES
a              pg_catalog          NULL                               NULL         admin    admin    USAGE           YES
a              pg_catalog          NULL                               NULL         admin    root     CREATE          YES
a              pg_catalog          NULL                               NULL         admin    root     DROP            YES
a              pg_catalog          NULL                               NULL         admin    root     USAGE           YES
a              pg_catalog          NULL                               NULL         root     public   USAGE           NO
a              pg_catalog          pg_am                              NULL         admin    public   SELECT          NO
a              pg_catalog          pg_attrdef                         NULL         admin    public   SELECT          NO
a              pg_catalog          pg_attribute                       NULL         admin    public   SELECT          NO
a              pg_catalog          pg_auth_members                    NULL         admin    public   SELECT          NO
a              pg_catalog          pg_class                           NULL         admin    public   SELECT          NO
a              pg_catalog          pg_collation                       NULL         admin    public   SELECT          NO
a              pg_catalog          pg_constraint                      NULL         admin    public   SELECT          NO
a              pg_catalog          pg_database                        NULL         admin    public   SELECT          NO
a              pg_catalog          pg_depend                          NULL         admin    public   SELECT          NO
a              pg_catalog          pg_description                     NULL         admin    public   SELECT          NO
a              pg_catalog          pg_enum                            NULL         admin    public   SELECT          NO
a              pg_catalog          pg_extension                       NULL         admin    public   SELECT          NO
a              pg_catalog          pg_foreign_data_wrapper            NULL         admin    public   SELECT          NO
a              pg_catalog          pg_foreign_server                  NULL         admin    public   SELECT          NO
a              pg_catalog          pg_foreign_table                   NULL         admin    public   SELECT          NO
a              pg_catalog          pg_index                           NULL         admin    public   SELECT          NO
a              pg_catalog          pg_indexes                         NULL         admin    public   SELECT          NO
a              pg_catalog          pg_inherits                        NULL         admin    public   SELECT          NO
a              pg_catalog          pg_language                        NULL         admin    public   SELECT          NO
a              pg_catalog          pg_namespace                       NULL         admin    public   SELECT          NO
a              pg_catalog          pg_nodestatus                      NULL         admin    public   SELECT          NO
a              pg_catalog          pg_operator                        NULL         admin    public   SELECT          NO
a              pg_catalog          pg_proc                            NULL         admin    public   SELECT          NO
a              pg_catalog          pg_range                           NULL         admin    public   SELECT          NO
a              pg_catalog          pg_rewrite                         NULL         admin    public   SELECT          NO
a              pg_catalog          pg_roles                           NULL         admin    public   SELECT          NO
a              pg_catalog          pg_seclabel                        NULL         admin    public   SELECT          NO
a              pg_catalog          pg_sequence                        NULL         admin    public   SELECT          NO
a              pg_catalog          pg_settings                        NULL         admin    public   SELECT          NO
a              pg_catalog          pg_shdescription                   NULL         admin    public   SELECT          NO
a              pg_catalog          pg_shseclabel                      NULL         admin    public   SELECT          NO
a              pg_catalog          pg_stat_activity                   NULL         admin    public   SELECT          NO
a              pg_catalog          pg_tables                          NULL         admin    public   SELECT          NO
a              pg_catalog          pg_tablespace                      NULL         admin    public   SELECT          NO
a              pg_catalog          pg_trigger                         NULL         admin    public   SELECT          NO
a              pg_catalog          pg_type                            NULL         admin    public   SELECT          NO
a              pg_catalog          pg_user                            NULL         admin    public   SELECT          NO
a              pg_catalog          pg_user_mapping                    NULL         admin    public   SELECT          NO
a              pg_catalog          pg_views                           NULL         admin    public   SELECT          NO
a              public              NULL                               NULL         admin    admin    CREATE          YES
a              public              NULL                               NULL         admin    admin    DROP            YES
a              public              NULL                               NULL         admin    admin    USAGE           YES
a              public              NULL                               NULL         admin    root     CREATE          YES
a              public              NULL                               NULL         admin    root     DROP            YES
a              public              NULL                               NULL         admin    root     USAGE           YES
a              public              NULL                               NULL         root     public   USAGE           NO
a              zbdb_internal       NULL                               NULL         admin    admin    CREATE          YES
a              zbdb_internal       NULL                               NULL         admin    admin    DROP            YES
a              zbdb_internal       NULL                               NULL         admin    admin    USAGE           YES
a              zbdb_internal       NULL                               NULL         admin    root     CREATE          YES
a              zbdb_internal       NULL                               NULL         admin    root     DROP            YES
a              zbdb_internal       NULL                               NULL         admin    root     USAGE           YES
a              zbdb_internal       NULL                               NULL         root     public   USAGE           NO
a              zbdb_internal       backward_dependencies              NULL         admin    public   SELECT          NO
a              zbdb_internal       builtin_functions                  NULL         admin    public   SELECT          NO
a              zbdb_internal       cluster_queries                    NULL         admin    public   SELECT          NO
a              zbdb_internal       cluster_sessions                   NULL         admin    public   SELECT          NO
a              zbdb_internal       cluster_settings                   NULL         admin    public   SELECT          NO
a              zbdb_internal       create_statements                  NULL         admin    public   SELECT          NO
a              zbdb_internal       databases                          NULL         admin    public   SELECT          NO
a              zbdb_internal       feature_usage                      NULL         admin    public   SELECT          NO
a              zbdb_internal       forward_dependencies               NULL         admin    public   SELECT          NO
a              zbdb_internal       function_privileges                NULL         admin    public   SELECT          NO
a              zbdb_internal       gossip_alerts                      NULL         admin    public   SELECT          NO
a              zbdb_internal       gossip_liveness                    NULL         admin    public   SELECT          NO
a              zbdb_internal       gossip_network                     NULL         admin    public   SELECT          NO
a              zbdb_internal       gossip_nodes                       NULL         admin    public   SELECT          NO
a              zbdb_internal       index_columns                      NULL         admin    public   SELECT          NO
a              zbdb_internal       jobs                               NULL         admin    public   SELECT          NO
a              zbdb_internal       kv_node_status                     NULL         admin    public   SELECT          NO
a              zbdb_internal       kv_store_status                    NULL         admin    public   SELECT          NO
a              zbdb_internal       leases                             NULL         admin    public   SELECT          NO
a              zbdb_internal       node_build_info                    NULL         admin    public   SELECT          NO
a              zbdb_internal       node_metrics                       NULL         admin    public   SELECT          NO
a              zbdb_internal       node_queries                       NULL         admin    public   SELECT          NO
a              zbdb_internal       node_runtime_info                  NULL         admin    public   SELECT          NO
a              zbdb_internal       node_sessions                      NULL         admin    public   SELECT          NO
a              zbdb_internal       node_statement_statistics          NULL         admin    public   SELECT          NO
a              zbdb_internal       partition_views                    NULL         admin    public   SELECT          NO
a              zbdb_internal       partitions                         NULL         admin    public   SELECT          NO
a              zbdb_internal       predefined_comments                NULL         admin    public   SELECT          NO
a              zbdb_internal       ranges                             NULL         admin    public   SELECT          NO
a              zbdb_internal       ranges_no_leases                   NULL         admin    public   SELECT          NO
a              zbdb_internal       savepoint_status                   NULL         admin    public   SELECT          NO
a              zbdb_internal       schema_changes                     NULL         admin    public   SELECT          NO
a              zbdb_internal       session_trace                      NULL         admin    public   SELECT          NO
a              zbdb_internal       session_variables                  NULL         admin    public   SELECT          NO
a              zbdb_internal       table_columns                      NULL         admin    public   SELECT          NO
a              zbdb_internal       table_indexes                      NULL         admin    public   SELECT          NO
a              zbdb_internal       table_row_statistics               NULL         admin    public   SELECT          NO
a              zbdb_internal       tables                             NULL         admin    public   SELECT          NO
a              zbdb_internal       zones                              NULL         admin    public   SELECT          NO
defaultdb      NULL                NULL                               NULL         admin    admin    CREATE          YES
defaultdb      NULL                NULL                               NULL         admin    admin    DROP            YES
defaultdb      NULL                NULL                               NULL         admin    admin    USAGE           YES
defaultdb      NULL                NULL                               NULL         admin    root     CREATE          YES
defaultdb      NULL                NULL                               NULL         admin    root     DROP            YES
defaultdb      NULL                NULL                               NULL         admin    root     USAGE           YES
defaultdb      information_schema  NULL                               NULL         admin    admin    CREATE          YES
defaultdb      information_schema  NULL                               NULL         admin    admin    DROP            YES
defaultdb      information_schema  NULL                               NULL         admin    admin    USAGE           YES
defaultdb      information_schema  NULL                               NULL         admin    root     CREATE          YES
defaultdb      information_schema  NULL                               NULL         admin    root     DROP            YES
defaultdb      information_schema  NULL                               NULL         admin    root     USAGE           YES
defaultdb      information_schema  administrable_role_authorizations  NULL         admin    public   SELECT          NO
defaultdb      information_schema  applicable_roles                   NULL         admin    public   SELECT          NO
defaultdb      information_schema  check_constraints                  NULL         admin    public   SELECT          NO
defaultdb      information_schema  column_privileges                  NULL         admin    public   SELECT          NO
defaultdb      information_schema  columns                            NULL         admin    public   SELECT          NO
defaultdb      information_schema  constraint_column_usage            NULL         admin    public   SELECT          NO
defaultdb      information_schema  database_privileges                NULL         admin    public   SELECT          NO
defaultdb      information_schema  enabled_roles                      NULL         admin    public   SELECT          NO
defaultdb      information_schema  functions                          NULL         admin    public   SELECT          NO
defaultdb      information_schema  index_partition                    NULL         admin    public   SELECT          NO
defaultdb      information_schema  key_column_usage                   NULL         admin    public   SELECT          NO
defaultdb      information_schema  parameters                         NULL         admin    public   SELECT          NO
defaultdb      information_schema  referential_constraints            NULL         admin    public   SELECT          NO
defaultdb      information_schema  role_table_grants                  NULL         admin    public   SELECT          NO
defaultdb      information_schema  routines                           NULL         admin    public   SELECT          NO
defaultdb      information_schema  schema_privileges                  NULL         admin    public   SELECT          NO
defaultdb      information_schema  schemata                           NULL         admin    public   SELECT          NO
defaultdb      information_schema  sequences                          NULL         admin    public   SELECT          NO
defaultdb      information_schema  statistics                         NULL         admin    public   SELECT          NO
defaultdb      information_schema  table_constraints                  NULL         admin    public   SELECT          NO
defaultdb      information_schema  table_privileges                   NULL         admin    public   SELECT          NO
defaultdb      information_schema  tables                             NULL         admin    public   SELECT          NO
defaultdb      information_schema  trigger_privileges                 NULL         admin    public   SELECT          NO
defaultdb      information_schema  user_privileges                    NULL         admin    public   SELECT          NO
defaultdb      information_schema  views                              NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          NULL                               NULL         admin    admin    CREATE          YES
defaultdb      pg_catalog          NULL                               NULL         admin    admin    DROP            YES
defaultdb      pg_catalog          NULL                               NULL         admin    admin    USAGE           YES
defaultdb      pg_catalog          NULL                               NULL         admin    root     CREATE          YES
defaultdb      pg_catalog          NULL                               NULL         admin    root     DROP            YES
defaultdb      pg_catalog          NULL                               NULL         admin    root     USAGE           YES
defaultdb      pg_catalog          pg_am                              NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_attrdef                         NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_attribute                       NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_auth_members                    NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_class                           NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_collation                       NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_constraint                      NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_database                        NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_depend                          NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_description                     NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_enum                            NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_extension                       NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_foreign_data_wrapper            NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_foreign_server                  NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_foreign_table                   NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_index                           NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_indexes                         NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_inherits                        NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_language                        NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_namespace                       NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_nodestatus                      NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_operator                        NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_proc                            NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_range                           NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_rewrite                         NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_roles                           NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_seclabel                        NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_sequence                        NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_settings                        NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_shdescription                   NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_shseclabel                      NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_stat_activity                   NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_tables                          NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_tablespace                      NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_trigger                         NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_type                            NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_user                            NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_user_mapping                    NULL         admin    public   SELECT          NO
defaultdb      pg_catalog          pg_views                           NULL         admin    public   SELECT          NO
defaultdb      public              NULL                               NULL         admin    admin    CREATE          YES
defaultdb      public              NULL                               NULL         admin    admin    DROP            YES
defaultdb      public              NULL                               NULL         admin    admin    USAGE           YES
defaultdb      public              NULL                               NULL         admin    root     CREATE          YES
defaultdb      public              NULL                               NULL         admin    root     DROP            YES
defaultdb      public              NULL                               NULL         admin    root     USAGE           YES
defaultdb      public              NULL                               NULL         root     public   USAGE           NO
defaultdb      zbdb_internal       NULL                               NULL         admin    admin    CREATE          YES
defaultdb      zbdb_internal       NULL                               NULL         admin    admin    DROP            YES
defaultdb      zbdb_internal       NULL                               NULL         admin    admin    USAGE           YES
defaultdb      zbdb_internal       NULL                               NULL         admin    root     CREATE          YES
defaultdb      zbdb_internal       NULL                               NULL         admin    root     DROP            YES
defaultdb      zbdb_internal       NULL                               NULL         admin    root     USAGE           YES
defaultdb      zbdb_internal       backward_dependencies              NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       builtin_functions                  NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       cluster_queries                    NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       cluster_sessions                   NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       cluster_settings                   NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       create_statements                  NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       databases                          NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       feature_usage                      NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       forward_dependencies               NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       function_privileges                NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       gossip_alerts                      NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       gossip_liveness                    NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       gossip_network                     NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       gossip_nodes                       NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       index_columns                      NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       jobs                               NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       kv_node_status                     NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       kv_store_status                    NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       leases                             NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       node_build_info                    NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       node_metrics                       NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       node_queries                       NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       node_runtime_info                  NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       node_sessions                      NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       node_statement_statistics          NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       partition_views                    NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       partitions                         NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       predefined_comments                NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       ranges                             NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       ranges_no_leases                   NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       savepoint_status                   NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       schema_changes                     NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       session_trace                      NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       session_variables                  NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       table_columns                      NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       table_indexes                      NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       table_row_statistics               NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       tables                             NULL         admin    public   SELECT          NO
defaultdb      zbdb_internal       zones                              NULL         admin    public   SELECT          NO
postgres       NULL                NULL                               NULL         admin    admin    CREATE          YES
postgres       NULL                NULL                               NULL         admin    admin    DROP            YES
postgres       NULL                NULL                               NULL         admin    admin    USAGE           YES
postgres       NULL                NULL                               NULL         admin    root     CREATE          YES
postgres       NULL                NULL                               NULL         admin    root     DROP            YES
postgres       NULL                NULL                               NULL         admin    root     USAGE           YES
postgres       information_schema  NULL                               NULL         admin    admin    CREATE          YES
postgres       information_schema  NULL                               NULL         admin    admin    DROP            YES
postgres       information_schema  NULL                               NULL         admin    admin    USAGE           YES
postgres       information_schema  NULL                               NULL         admin    root     CREATE          YES
postgres       information_schema  NULL                               NULL         admin    root     DROP            YES
postgres       information_schema  NULL                               NULL         admin    root     USAGE           YES
postgres       information_schema  administrable_role_authorizations  NULL         admin    public   SELECT          NO
postgres       information_schema  applicable_roles                   NULL         admin    public   SELECT          NO
postgres       information_schema  check_constraints                  NULL         admin    public   SELECT          NO
postgres       information_schema  column_privileges                  NULL         admin    public   SELECT          NO
postgres       information_schema  columns                            NULL         admin    public   SELECT          NO
postgres       information_schema  constraint_column_usage            NULL         admin    public   SELECT          NO
postgres       information_schema  database_privileges                NULL         admin    public   SELECT          NO
postgres       information_schema  enabled_roles                      NULL         admin    public   SELECT          NO
postgres       information_schema  functions                          NULL         admin    public   SELECT          NO
postgres       information_schema  index_partition                    NULL         admin    public   SELECT          NO
postgres       information_schema  key_column_usage                   NULL         admin    public   SELECT          NO
postgres       information_schema  parameters                         NULL         admin    public   SELECT          NO
postgres       information_schema  referential_constraints            NULL         admin    public   SELECT          NO
postgres       information_schema  role_table_grants                  NULL         admin    public   SELECT          NO
postgres       information_schema  routines                           NULL         admin    public   SELECT          NO
postgres       information_schema  schema_privileges                  NULL         admin    public   SELECT          NO
postgres       information_schema  schemata                           NULL         admin    public   SELECT          NO
postgres       information_schema  sequences                          NULL         admin    public   SELECT          NO
postgres       information_schema  statistics                         NULL         admin    public   SELECT          NO
postgres       information_schema  table_constraints                  NULL         admin    public   SELECT          NO
postgres       information_schema  table_privileges                   NULL         admin    public   SELECT          NO
postgres       information_schema  tables                             NULL         admin    public   SELECT          NO
postgres       information_schema  trigger_privileges                 NULL         admin    public   SELECT          NO
postgres       information_schema  user_privileges                    NULL         admin    public   SELECT          NO
postgres       information_schema  views                              NULL         admin    public   SELECT          NO
postgres       pg_catalog          NULL                               NULL         admin    admin    CREATE          YES
postgres       pg_catalog          NULL                               NULL         admin    admin    DROP            YES
postgres       pg_catalog          NULL                               NULL         admin    admin    USAGE           YES
postgres       pg_catalog          NULL                               NULL         admin    root     CREATE          YES
postgres       pg_catalog          NULL                               NULL         admin    root     DROP            YES
postgres       pg_catalog          NULL                               NULL         admin    root     USAGE           YES
postgres       pg_catalog          pg_am                              NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_attrdef                         NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_attribute                       NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_auth_members                    NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_class                           NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_collation                       NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_constraint                      NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_database                        NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_depend                          NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_description                     NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_enum                            NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_extension                       NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_foreign_data_wrapper            NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_foreign_server                  NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_foreign_table                   NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_index                           NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_indexes                         NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_inherits                        NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_language                        NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_namespace                       NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_nodestatus                      NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_operator                        NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_proc                            NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_range                           NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_rewrite                         NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_roles                           NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_seclabel                        NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_sequence                        NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_settings                        NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_shdescription                   NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_shseclabel                      NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_stat_activity                   NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_tables                          NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_tablespace                      NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_trigger                         NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_type                            NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_user                            NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_user_mapping                    NULL         admin    public   SELECT          NO
postgres       pg_catalog          pg_views                           NULL         admin    public   SELECT          NO
postgres       public              NULL                               NULL         admin    admin    CREATE          YES
postgres       public              NULL                               NULL         admin    admin    DROP            YES
postgres       public              NULL                               NULL         admin    admin    USAGE           YES
postgres       public              NULL                               NULL         admin    root     CREATE          YES
postgres       public              NULL                               NULL         admin    root     DROP            YES
postgres       public              NULL                               NULL         admin    root     USAGE           YES
postgres       zbdb_internal       NULL                               NULL         admin    admin    CREATE          YES
postgres       zbdb_internal       NULL                               NULL         admin    admin    DROP            YES
postgres       zbdb_internal       NULL                               NULL         admin    admin    USAGE           YES
postgres       zbdb_internal       NULL                               NULL         admin    root     CREATE          YES
postgres       zbdb_internal       NULL                               NULL         admin    root     DROP            YES
postgres       zbdb_internal       NULL                               NULL         admin    root     USAGE           YES
postgres       zbdb_internal       backward_dependencies              NULL         admin    public   SELECT          NO
postgres       zbdb_internal       builtin_functions                  NULL         admin    public   SELECT          NO
postgres       zbdb_internal       cluster_queries                    NULL         admin    public   SELECT          NO
postgres       zbdb_internal       cluster_sessions                   NULL         admin    public   SELECT          NO
postgres       zbdb_internal       cluster_settings                   NULL         admin    public   SELECT          NO
postgres       zbdb_internal       create_statements                  NULL         admin    public   SELECT          NO
postgres       zbdb_internal       databases                          NULL         admin    public   SELECT          NO
postgres       zbdb_internal       feature_usage                      NULL         admin    public   SELECT          NO
postgres       zbdb_internal       forward_dependencies               NULL         admin    public   SELECT          NO
postgres       zbdb_internal       function_privileges                NULL         admin    public   SELECT          NO
postgres       zbdb_internal       gossip_alerts                      NULL         admin    public   SELECT          NO
postgres       zbdb_internal       gossip_liveness                    NULL         admin    public   SELECT          NO
postgres       zbdb_internal       gossip_network                     NULL         admin    public   SELECT          NO
postgres       zbdb_internal       gossip_nodes                       NULL         admin    public   SELECT          NO
postgres       zbdb_internal       index_columns                      NULL         admin    public   SELECT          NO
postgres       zbdb_internal       jobs                               NULL         admin    public   SELECT          NO
postgres       zbdb_internal       kv_node_status                     NULL         admin    public   SELECT          NO
postgres       zbdb_internal       kv_store_status                    NULL         admin    public   SELECT          NO
postgres       zbdb_internal       leases                             NULL         admin    public   SELECT          NO
postgres       zbdb_internal       node_build_info                    NULL         admin    public   SELECT          NO
postgres       zbdb_internal       node_metrics                       NULL         admin    public   SELECT          NO
postgres       zbdb_internal       node_queries                       NULL         admin    public   SELECT          NO
postgres       zbdb_internal       node_runtime_info                  NULL         admin    public   SELECT          NO
postgres       zbdb_internal       node_sessions                      NULL         admin    public   SELECT          NO
postgres       zbdb_internal       node_statement_statistics          NULL         admin    public   SELECT          NO
postgres       zbdb_internal       partition_views                    NULL         admin    public   SELECT          NO
postgres       zbdb_internal       partitions                         NULL         admin    public   SELECT          NO
postgres       zbdb_internal       predefined_comments                NULL         admin    public   SELECT          NO
postgres       zbdb_internal       ranges                             NULL         admin    public   SELECT          NO
postgres       zbdb_internal       ranges_no_leases                   NULL         admin    public   SELECT          NO
postgres       zbdb_internal       savepoint_status                   NULL         admin    public   SELECT          NO
postgres       zbdb_internal       schema_changes                     NULL         admin    public   SELECT          NO
postgres       zbdb_internal       session_trace                      NULL         admin    public   SELECT          NO
postgres       zbdb_internal       session_variables                  NULL         admin    public   SELECT          NO
postgres       zbdb_internal       table_columns                      NULL         admin    public   SELECT          NO
postgres       zbdb_internal       table_indexes                      NULL         admin    public   SELECT          NO
postgres       zbdb_internal       table_row_statistics               NULL         admin    public   SELECT          NO
postgres       zbdb_internal       tables                             NULL         admin    public   SELECT          NO
postgres       zbdb_internal       zones                              NULL         admin    public   SELECT          NO
system         NULL                NULL                               NULL         admin    admin    USAGE           YES
system         NULL                NULL                               NULL         admin    root     USAGE           YES
system         information_schema  NULL                               NULL         admin    admin    USAGE           YES
system         information_schema  NULL                               NULL         admin    root     USAGE           YES
system         information_schema  administrable_role_authorizations  NULL         admin    public   SELECT          NO
system         information_schema  applicable_roles                   NULL         admin    public   SELECT          NO
system         information_schema  check_constraints                  NULL         admin    public   SELECT          NO
system         information_schema  column_privileges                  NULL         admin    public   SELECT          NO
system         information_schema  columns                            NULL         admin    public   SELECT          NO
system         information_schema  constraint_column_usage            NULL         admin    public   SELECT          NO
system         information_schema  database_privileges                NULL         admin    public   SELECT          NO
system         information_schema  enabled_roles                      NULL         admin    public   SELECT          NO
system         information_schema  functions                          NULL         admin    public   SELECT          NO
system         information_schema  index_partition                    NULL         admin    public   SELECT          NO
system         information_schema  key_column_usage                   NULL         admin    public   SELECT          NO
system         information_schema  parameters                         NULL         admin    public   SELECT          NO
system         information_schema  referential_constraints            NULL         admin    public   SELECT          NO
system         information_schema  role_table_grants                  NULL         admin    public   SELECT          NO
system         information_schema  routines                           NULL         admin    public   SELECT          NO
system         information_schema  schema_privileges                  NULL         admin    public   SELECT          NO
system         information_schema  schemata                           NULL         admin    public   SELECT          NO
system         information_schema  sequences                          NULL         admin    public   SELECT          NO
system         information_schema  statistics                         NULL         admin    public   SELECT          NO
system         information_schema  table_constraints                  NULL         admin    public   SELECT          NO
system         information_schema  table_privileges                   NULL         admin    public   SELECT          NO
system         information_schema  tables                             NULL         admin    public   SELECT          NO
system         information_schema  trigger_privileges                 NULL         admin    public   SELECT          NO
system         information_schema  user_privileges                    NULL         admin    public   SELECT          NO
system         information_schema  views                              NULL         admin    public   SELECT          NO
system         pg_catalog          NULL                               NULL         admin    admin    USAGE           YES
system         pg_catalog          NULL                               NULL         admin    root     USAGE           YES
system         pg_catalog          pg_am                              NULL         admin    public   SELECT          NO
system         pg_catalog          pg_attrdef                         NULL         admin    public   SELECT          NO
system         pg_catalog          pg_attribute                       NULL         admin    public   SELECT          NO
system         pg_catalog          pg_auth_members                    NULL         admin    public   SELECT          NO
system         pg_catalog          pg_class                           NULL         admin    public   SELECT          NO
system         pg_catalog          pg_collation                       NULL         admin    public   SELECT          NO
system         pg_catalog          pg_constraint                      NULL         admin    public   SELECT          NO
system         pg_catalog          pg_database                        NULL         admin    public   SELECT          NO
system         pg_catalog          pg_depend                          NULL         admin    public   SELECT          NO
system         pg_catalog          pg_description                     NULL         admin    public   SELECT          NO
system         pg_catalog          pg_enum                            NULL         admin    public   SELECT          NO
system         pg_catalog          pg_extension                       NULL         admin    public   SELECT          NO
system         pg_catalog          pg_foreign_data_wrapper            NULL         admin    public   SELECT          NO
system         pg_catalog          pg_foreign_server                  NULL         admin    public   SELECT          NO
system         pg_catalog          pg_foreign_table                   NULL         admin    public   SELECT          NO
system         pg_catalog          pg_index                           NULL         admin    public   SELECT          NO
system         pg_catalog          pg_indexes                         NULL         admin    public   SELECT          NO
system         pg_catalog          pg_inherits                        NULL         admin    public   SELECT          NO
system         pg_catalog          pg_language                        NULL         admin    public   SELECT          NO
system         pg_catalog          pg_namespace                       NULL         admin    public   SELECT          NO
system         pg_catalog          pg_nodestatus                      NULL         admin    public   SELECT          NO
system         pg_catalog          pg_operator                        NULL         admin    public   SELECT          NO
system         pg_catalog          pg_proc                            NULL         admin    public   SELECT          NO
system         pg_catalog          pg_range                           NULL         admin    public   SELECT          NO
system         pg_catalog          pg_rewrite                         NULL         admin    public   SELECT          NO
system         pg_catalog          pg_roles                           NULL         admin    public   SELECT          NO
system         pg_catalog          pg_seclabel                        NULL         admin    public   SELECT          NO
system         pg_catalog          pg_sequence                        NULL         admin    public   SELECT          NO
system         pg_catalog          pg_settings                        NULL         admin    public   SELECT          NO
system         pg_catalog          pg_shdescription                   NULL         admin    public   SELECT          NO
system         pg_catalog          pg_shseclabel                      NULL         admin    public   SELECT          NO
system         pg_catalog          pg_stat_activity                   NULL         admin    public   SELECT          NO
system         pg_catalog          pg_tables                          NULL         admin    public   SELECT          NO
system         pg_catalog          pg_tablespace                      NULL         admin    public   SELECT          NO
system         pg_catalog          pg_trigger                         NULL         admin    public   SELECT          NO
system         pg_catalog          pg_type                            NULL         admin    public   SELECT          NO
system         pg_catalog          pg_user                            NULL         admin    public   SELECT          NO
system         pg_catalog          pg_user_mapping                    NULL         admin    public   SELECT          NO
system         pg_catalog          pg_views                           NULL         admin    public   SELECT          NO
system         public              NULL                               NULL         admin    admin    USAGE           YES
system         public              NULL                               NULL         admin    root     USAGE           YES
system         public              authentication                     NULL         admin    admin    DELETE          YES
system         public              authentication                     NULL         admin    admin    INSERT          YES
system         public              authentication                     NULL         admin    admin    SELECT          YES
system         public              authentication                     NULL         admin    admin    UPDATE          YES
system         public              authentication                     NULL         admin    root     DELETE          YES
system         public              authentication                     NULL         admin    root     INSERT          YES
system         public              authentication                     NULL         admin    root     SELECT          YES
system         public              authentication                     NULL         admin    root     UPDATE          YES
system         public              comments                           NULL         admin    admin    DELETE          YES
system         public              comments                           NULL         admin    admin    INSERT          YES
system         public              comments                           NULL         admin    admin    SELECT          YES
system         public              comments                           NULL         admin    admin    UPDATE          YES
system         public              comments                           NULL         admin    public   DELETE          YES
system         public              comments                           NULL         admin    public   INSERT          YES
system         public              comments                           NULL         admin    public   SELECT          YES
system         public              comments                           NULL         admin    public   UPDATE          YES
system         public              comments                           NULL         admin    root     DELETE          YES
system         public              comments                           NULL         admin    root     INSERT          YES
system         public              comments                           NULL         admin    root     SELECT          YES
system         public              comments                           NULL         admin    root     UPDATE          YES
system         public              descriptor                         NULL         admin    admin    SELECT          YES
system         public              descriptor                         NULL         admin    root     SELECT          YES
system         public              eventlog                           NULL         admin    admin    DELETE          YES
system         public              eventlog                           NULL         admin    admin    INSERT          YES
system         public              eventlog                           NULL         admin    admin    SELECT          YES
system         public              eventlog                           NULL         admin    admin    UPDATE          YES
system         public              eventlog                           NULL         admin    root     DELETE          YES
system         public              eventlog                           NULL         admin    root     INSERT          YES
system         public              eventlog                           NULL         admin    root     SELECT          YES
system         public              eventlog                           NULL         admin    root     UPDATE          YES
system         public              flashback                          NULL         admin    admin    DELETE          YES
system         public              flashback                          NULL         admin    admin    INSERT          YES
system         public              flashback                          NULL         admin    admin    SELECT          YES
system         public              flashback                          NULL         admin    admin    UPDATE          YES
system         public              flashback                          NULL         admin    public   DELETE          YES
system         public              flashback                          NULL         admin    public   INSERT          YES
system         public              flashback                          NULL         admin    public   SELECT          YES
system         public              flashback                          NULL         admin    public   UPDATE          YES
system         public              flashback                          NULL         admin    root     DELETE          YES
system         public              flashback                          NULL         admin    root     INSERT          YES
system         public              flashback                          NULL         admin    root     SELECT          YES
system         public              flashback                          NULL         admin    root     UPDATE          YES
system         public              function_namespace                 NULL         admin    admin    SELECT          YES
system         public              function_namespace                 NULL         admin    root     SELECT          YES
system         public              hints                              NULL         admin    admin    DELETE          YES
system         public              hints                              NULL         admin    admin    INSERT          YES
system         public              hints                              NULL         admin    admin    SELECT          YES
system         public              hints                              NULL         admin    admin    UPDATE          YES
system         public              hints                              NULL         admin    root     DELETE          YES
system         public              hints                              NULL         admin    root     INSERT          YES
system         public              hints                              NULL         admin    root     SELECT          YES
system         public              hints                              NULL         admin    root     UPDATE          YES
system         public              jobs                               NULL         admin    admin    DELETE          YES
system         public              jobs                               NULL         admin    admin    INSERT          YES
system         public              jobs                               NULL         admin    admin    SELECT          YES
system         public              jobs                               NULL         admin    admin    UPDATE          YES
system         public              jobs                               NULL         admin    root     DELETE          YES
system         public              jobs                               NULL         admin    root     INSERT          YES
system         public              jobs                               NULL         admin    root     SELECT          YES
system         public              jobs                               NULL         admin    root     UPDATE          YES
system         public              lease                              NULL         admin    admin    DELETE          YES
system         public              lease                              NULL         admin    admin    INSERT          YES
system         public              lease                              NULL         admin    admin    SELECT          YES
system         public              lease                              NULL         admin    admin    UPDATE          YES
system         public              lease                              NULL         admin    root     DELETE          YES
system         public              lease                              NULL         admin    root     INSERT          YES
system         public              lease                              NULL         admin    root     SELECT          YES
system         public              lease                              NULL         admin    root     UPDATE          YES
system         public              location                           NULL         admin    admin    DELETE          YES
system         public              location                           NULL         admin    admin    INSERT          YES
system         public              location                           NULL         admin    admin    SELECT          YES
system         public              location                           NULL         admin    admin    UPDATE          YES
system         public              location                           NULL         admin    root     DELETE          YES
system         public              location                           NULL         admin    root     INSERT          YES
system         public              location                           NULL         admin    root     SELECT          YES
system         public              location                           NULL         admin    root     UPDATE          YES
system         public              locations                          NULL         admin    admin    DELETE          YES
system         public              locations                          NULL         admin    admin    INSERT          YES
system         public              locations                          NULL         admin    admin    SELECT          YES
system         public              locations                          NULL         admin    admin    UPDATE          YES
system         public              locations                          NULL         admin    root     DELETE          YES
system         public              locations                          NULL         admin    root     INSERT          YES
system         public              locations                          NULL         admin    root     SELECT          YES
system         public              locations                          NULL         admin    root     UPDATE          YES
system         public              namespace                          NULL         admin    admin    SELECT          YES
system         public              namespace                          NULL         admin    root     SELECT          YES
system         public              rangelog                           NULL         admin    admin    DELETE          YES
system         public              rangelog                           NULL         admin    admin    INSERT          YES
system         public              rangelog                           NULL         admin    admin    SELECT          YES
system         public              rangelog                           NULL         admin    admin    UPDATE          YES
system         public              rangelog                           NULL         admin    root     DELETE          YES
system         public              rangelog                           NULL         admin    root     INSERT          YES
system         public              rangelog                           NULL         admin    root     SELECT          YES
system         public              rangelog                           NULL         admin    root     UPDATE          YES
system         public              role_members                       NULL         admin    admin    DELETE          YES
system         public              role_members                       NULL         admin    admin    INSERT          YES
system         public              role_members                       NULL         admin    admin    SELECT          YES
system         public              role_members                       NULL         admin    admin    UPDATE          YES
system         public              role_members                       NULL         admin    root     DELETE          YES
system         public              role_members                       NULL         admin    root     INSERT          YES
system         public              role_members                       NULL         admin    root     SELECT          YES
system         public              role_members                       NULL         admin    root     UPDATE          YES
system         public              scheduled_jobs                     NULL         admin    admin    DELETE          YES
system         public              scheduled_jobs                     NULL         admin    admin    INSERT          YES
system         public              scheduled_jobs                     NULL         admin    admin    SELECT          YES
system         public              scheduled_jobs                     NULL         admin    admin    UPDATE          YES
system         public              scheduled_jobs                     NULL         admin    root     DELETE          YES
system         public              scheduled_jobs                     NULL         admin    root     INSERT          YES
system         public              scheduled_jobs                     NULL         admin    root     SELECT          YES
system         public              scheduled_jobs                     NULL         admin    root     UPDATE          YES
system         public              settings                           NULL         admin    admin    DELETE          YES
system         public              settings                           NULL         admin    admin    INSERT          YES
system         public              settings                           NULL         admin    admin    SELECT          YES
system         public              settings                           NULL         admin    admin    UPDATE          YES
system         public              settings                           NULL         admin    root     DELETE          YES
system         public              settings                           NULL         admin    root     INSERT          YES
system         public              settings                           NULL         admin    root     SELECT          YES
system         public              settings                           NULL         admin    root     UPDATE          YES
system         public              snapshots                          NULL         admin    admin    DELETE          YES
system         public              snapshots                          NULL         admin    admin    INSERT          YES
system         public              snapshots                          NULL         admin    admin    SELECT          YES
system         public              snapshots                          NULL         admin    admin    UPDATE          YES
system         public              snapshots                          NULL         admin    public   DELETE          YES
system         public              snapshots                          NULL         admin    public   INSERT          YES
system         public              snapshots                          NULL         admin    public   SELECT          YES
system         public              snapshots                          NULL         admin    public   UPDATE          YES
system         public              snapshots                          NULL         admin    root     DELETE          YES
system         public              snapshots                          NULL         admin    root     INSERT          YES
system         public              snapshots                          NULL         admin    root     SELECT          YES
system         public              snapshots                          NULL         admin    root     UPDATE          YES
system         public              table_statistics                   NULL         admin    admin    DELETE          YES
system         public              table_statistics                   NULL         admin    admin    INSERT          YES
system         public              table_statistics                   NULL         admin    admin    SELECT          YES
system         public              table_statistics                   NULL         admin    admin    UPDATE          YES
system         public              table_statistics                   NULL         admin    root     DELETE          YES
system         public              table_statistics                   NULL         admin    root     INSERT          YES
system         public              table_statistics                   NULL         admin    root     SELECT          YES
system         public              table_statistics                   NULL         admin    root     UPDATE          YES
system         public              triggers                           NULL         admin    admin    DELETE          YES
system         public              triggers                           NULL         admin    admin    INSERT          YES
system         public              triggers                           NULL         admin    admin    SELECT          YES
system         public              triggers                           NULL         admin    admin    UPDATE          YES
system         public              triggers                           NULL         admin    root     DELETE          YES
system         public              triggers                           NULL         admin    root     INSERT          YES
system         public              triggers                           NULL         admin    root     SELECT          YES
system         public              triggers                           NULL         admin    root     UPDATE          YES
system         public              ui                                 NULL         admin    admin    DELETE          YES
system         public              ui                                 NULL         admin    admin    INSERT          YES
system         public              ui                                 NULL         admin    admin    SELECT          YES
system         public              ui                                 NULL         admin    admin    UPDATE          YES
system         public              ui                                 NULL         admin    root     DELETE          YES
system         public              ui                                 NULL         admin    root     INSERT          YES
system         public              ui                                 NULL         admin    root     SELECT          YES
system         public              ui                                 NULL         admin    root     UPDATE          YES
system         public              user_options                       NULL         admin    admin    DELETE          YES
system         public              user_options                       NULL         admin    admin    INSERT          YES
system         public              user_options                       NULL         admin    admin    SELECT          YES
system         public              user_options                       NULL         admin    admin    UPDATE          YES
system         public              user_options                       NULL         admin    root     DELETE          YES
system         public              user_options                       NULL         admin    root     INSERT          YES
system         public              user_options                       NULL         admin    root     SELECT          YES
system         public              user_options                       NULL         admin    root     UPDATE          YES
system         public              users                              NULL         admin    admin    DELETE          YES
system         public              users                              NULL         admin    admin    INSERT          YES
system         public              users                              NULL         admin    admin    SELECT          YES
system         public              users                              NULL         admin    admin    UPDATE          YES
system         public              users                              NULL         admin    root     DELETE          YES
system         public              users                              NULL         admin    root     INSERT          YES
system         public              users                              NULL         admin    root     SELECT          YES
system         public              users                              NULL         admin    root     UPDATE          YES
system         public              web_sessions                       NULL         admin    admin    DELETE          YES
system         public              web_sessions                       NULL         admin    admin    INSERT          YES
system         public              web_sessions                       NULL         admin    admin    SELECT          YES
system         public              web_sessions                       NULL         admin    admin    UPDATE          YES
system         public              web_sessions                       NULL         admin    root     DELETE          YES
system         public              web_sessions                       NULL         admin    root     INSERT          YES
system         public              web_sessions                       NULL         admin    root     SELECT          YES
system         public              web_sessions                       NULL         admin    root     UPDATE          YES
system         public              zones                              NULL         admin    admin    DELETE          YES
system         public              zones                              NULL         admin    admin    INSERT          YES
system         public              zones                              NULL         admin    admin    SELECT          YES
system         public              zones                              NULL         admin    admin    UPDATE          YES
system         public              zones                              NULL         admin    root     DELETE          YES
system         public              zones                              NULL         admin    root     INSERT          YES
system         public              zones                              NULL         admin    root     SELECT          YES
system         public              zones                              NULL         admin    root     UPDATE          YES
system         zbdb_internal       NULL                               NULL         admin    admin    USAGE           YES
system         zbdb_internal       NULL                               NULL         admin    root     USAGE           YES
system         zbdb_internal       backward_dependencies              NULL         admin    public   SELECT          NO
system         zbdb_internal       builtin_functions                  NULL         admin    public   SELECT          NO
system         zbdb_internal       cluster_queries                    NULL         admin    public   SELECT          NO
system         zbdb_internal       cluster_sessions                   NULL         admin    public   SELECT          NO
system         zbdb_internal       cluster_settings                   NULL         admin    public   SELECT          NO
system         zbdb_internal       create_statements                  NULL         admin    public   SELECT          NO
system         zbdb_internal       databases                          NULL         admin    public   SELECT          NO
system         zbdb_internal       feature_usage                      NULL         admin    public   SELECT          NO
system         zbdb_internal       forward_dependencies               NULL         admin    public   SELECT          NO
system         zbdb_internal       function_privileges                NULL         admin    public   SELECT          NO
system         zbdb_internal       gossip_alerts                      NULL         admin    public   SELECT          NO
system         zbdb_internal       gossip_liveness                    NULL         admin    public   SELECT          NO
system         zbdb_internal       gossip_network                     NULL         admin    public   SELECT          NO
system         zbdb_internal       gossip_nodes                       NULL         admin    public   SELECT          NO
system         zbdb_internal       index_columns                      NULL         admin    public   SELECT          NO
system         zbdb_internal       jobs                               NULL         admin    public   SELECT          NO
system         zbdb_internal       kv_node_status                     NULL         admin    public   SELECT          NO
system         zbdb_internal       kv_store_status                    NULL         admin    public   SELECT          NO
system         zbdb_internal       leases                             NULL         admin    public   SELECT          NO
system         zbdb_internal       node_build_info                    NULL         admin    public   SELECT          NO
system         zbdb_internal       node_metrics                       NULL         admin    public   SELECT          NO
system         zbdb_internal       node_queries                       NULL         admin    public   SELECT          NO
system         zbdb_internal       node_runtime_info                  NULL         admin    public   SELECT          NO
system         zbdb_internal       node_sessions                      NULL         admin    public   SELECT          NO
system         zbdb_internal       node_statement_statistics          NULL         admin    public   SELECT          NO
system         zbdb_internal       partition_views                    NULL         admin    public   SELECT          NO
system         zbdb_internal       partitions                         NULL         admin    public   SELECT          NO
system         zbdb_internal       predefined_comments                NULL         admin    public   SELECT          NO
system         zbdb_internal       ranges                             NULL         admin    public   SELECT          NO
system         zbdb_internal       ranges_no_leases                   NULL         admin    public   SELECT          NO
system         zbdb_internal       savepoint_status                   NULL         admin    public   SELECT          NO
system         zbdb_internal       schema_changes                     NULL         admin    public   SELECT          NO
system         zbdb_internal       session_trace                      NULL         admin    public   SELECT          NO
system         zbdb_internal       session_variables                  NULL         admin    public   SELECT          NO
system         zbdb_internal       table_columns                      NULL         admin    public   SELECT          NO
system         zbdb_internal       table_indexes                      NULL         admin    public   SELECT          NO
system         zbdb_internal       table_row_statistics               NULL         admin    public   SELECT          NO
system         zbdb_internal       tables                             NULL         admin    public   SELECT          NO
system         zbdb_internal       zones                              NULL         admin    public   SELECT          NO
test           NULL                NULL                               NULL         admin    admin    CREATE          YES
test           NULL                NULL                               NULL         admin    admin    DROP            YES
test           NULL                NULL                               NULL         admin    admin    USAGE           YES
test           NULL                NULL                               NULL         admin    root     CREATE          YES
test           NULL                NULL                               NULL         admin    root     DROP            YES
test           NULL                NULL                               NULL         admin    root     USAGE           YES
test           information_schema  NULL                               NULL         admin    admin    CREATE          YES
test           information_schema  NULL                               NULL         admin    admin    DROP            YES
test           information_schema  NULL                               NULL         admin    admin    USAGE           YES
test           information_schema  NULL                               NULL         admin    root     CREATE          YES
test           information_schema  NULL                               NULL         admin    root     DROP            YES
test           information_schema  NULL                               NULL         admin    root     USAGE           YES
test           information_schema  administrable_role_authorizations  NULL         admin    public   SELECT          NO
test           information_schema  applicable_roles                   NULL         admin    public   SELECT          NO
test           information_schema  check_constraints                  NULL         admin    public   SELECT          NO
test           information_schema  column_privileges                  NULL         admin    public   SELECT          NO
test           information_schema  columns                            NULL         admin    public   SELECT          NO
test           information_schema  constraint_column_usage            NULL         admin    public   SELECT          NO
test           information_schema  database_privileges                NULL         admin    public   SELECT          NO
test           information_schema  enabled_roles                      NULL         admin    public   SELECT          NO
test           information_schema  functions                          NULL         admin    public   SELECT          NO
test           information_schema  index_partition                    NULL         admin    public   SELECT          NO
test           information_schema  key_column_usage                   NULL         admin    public   SELECT          NO
test           information_schema  parameters                         NULL         admin    public   SELECT          NO
test           information_schema  referential_constraints            NULL         admin    public   SELECT          NO
test           information_schema  role_table_grants                  NULL         admin    public   SELECT          NO
test           information_schema  routines                           NULL         admin    public   SELECT          NO
test           information_schema  schema_privileges                  NULL         admin    public   SELECT          NO
test           information_schema  schemata                           NULL         admin    public   SELECT          NO
test           information_schema  sequences                          NULL         admin    public   SELECT          NO
test           information_schema  statistics                         NULL         admin    public   SELECT          NO
test           information_schema  table_constraints                  NULL         admin    public   SELECT          NO
test           information_schema  table_privileges                   NULL         admin    public   SELECT          NO
test           information_schema  tables                             NULL         admin    public   SELECT          NO
test           information_schema  trigger_privileges                 NULL         admin    public   SELECT          NO
test           information_schema  user_privileges                    NULL         admin    public   SELECT          NO
test           information_schema  views                              NULL         admin    public   SELECT          NO
test           pg_catalog          NULL                               NULL         admin    admin    CREATE          YES
test           pg_catalog          NULL                               NULL         admin    admin    DROP            YES
test           pg_catalog          NULL                               NULL         admin    admin    USAGE           YES
test           pg_catalog          NULL                               NULL         admin    root     CREATE          YES
test           pg_catalog          NULL                               NULL         admin    root     DROP            YES
test           pg_catalog          NULL                               NULL         admin    root     USAGE           YES
test           pg_catalog          pg_am                              NULL         admin    public   SELECT          NO
test           pg_catalog          pg_attrdef                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_attribute                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_auth_members                    NULL         admin    public   SELECT          NO
test           pg_catalog          pg_class                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_collation                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_constraint                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_database                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_depend                          NULL         admin    public   SELECT          NO
test           pg_catalog          pg_description                     NULL         admin    public   SELECT          NO
test           pg_catalog          pg_enum                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_extension                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_data_wrapper            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_server                  NULL         admin    public   SELECT          NO
test           pg_catalog          pg_foreign_table                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_index                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_indexes                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_inherits                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_language                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_namespace                       NULL         admin    public   SELECT          NO
test           pg_catalog          pg_nodestatus                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_operator                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_proc                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_range                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_rewrite                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_roles                           NULL         admin    public   SELECT          NO
test           pg_catalog          pg_seclabel                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_sequence                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_settings                        NULL         admin    public   SELECT          NO
test           pg_catalog          pg_shdescription                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_shseclabel                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_stat_activity                   NULL         admin    public   SELECT          NO
test           pg_catalog          pg_tables                          NULL         admin    public   SELECT          NO
test           pg_catalog          pg_tablespace                      NULL         admin    public   SELECT          NO
test           pg_catalog          pg_trigger                         NULL         admin    public   SELECT          NO
test           pg_catalog          pg_type                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_user                            NULL         admin    public   SELECT          NO
test           pg_catalog          pg_user_mapping                    NULL         admin    public   SELECT          NO
test           pg_catalog          pg_views                           NULL         admin    public   SELECT          NO
test           public              NULL                               NULL         admin    admin    CREATE          YES
test           public              NULL                               NULL         admin    admin    DROP            YES
test           public              NULL                               NULL         admin    admin    USAGE           YES
test           public              NULL                               NULL         admin    root     CREATE          YES
test           public              NULL                               NULL         admin    root     DROP            YES
test           public              NULL                               NULL         admin    root     USAGE           YES
test           public              NULL                               NULL         root     public   USAGE           NO
test           zbdb_internal       NULL                               NULL         admin    admin    CREATE          YES
test           zbdb_internal       NULL                               NULL         admin    admin    DROP            YES
test           zbdb_internal       NULL                               NULL         admin    admin    USAGE           YES
test           zbdb_internal       NULL                               NULL         admin    root     CREATE          YES
test           zbdb_internal       NULL                               NULL         admin    root     DROP            YES
test           zbdb_internal       NULL                               NULL         admin    root     USAGE           YES
test           zbdb_internal       backward_dependencies              NULL         admin    public   SELECT          NO
test           zbdb_internal       builtin_functions                  NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_queries                    NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_sessions                   NULL         admin    public   SELECT          NO
test           zbdb_internal       cluster_settings                   NULL         admin    public   SELECT          NO
test           zbdb_internal       create_statements                  NULL         admin    public   SELECT          NO
test           zbdb_internal       databases                          NULL         admin    public   SELECT          NO
test           zbdb_internal       feature_usage                      NULL         admin    public   SELECT          NO
test           zbdb_internal       forward_dependencies               NULL         admin    public   SELECT          NO
test           zbdb_internal       function_privileges                NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_alerts                      NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_liveness                    NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_network                     NULL         admin    public   SELECT          NO
test           zbdb_internal       gossip_nodes                       NULL         admin    public   SELECT          NO
test           zbdb_internal       index_columns                      NULL         admin    public   SELECT          NO
test           zbdb_internal       jobs                               NULL         admin    public   SELECT          NO
test           zbdb_internal       kv_node_status                     NULL         admin    public   SELECT          NO
test           zbdb_internal       kv_store_status                    NULL         admin    public   SELECT          NO
test           zbdb_internal       leases                             NULL         admin    public   SELECT          NO
test           zbdb_internal       node_build_info                    NULL         admin    public   SELECT          NO
test           zbdb_internal       node_metrics                       NULL         admin    public   SELECT          NO
test           zbdb_internal       node_queries                       NULL         admin    public   SELECT          NO
test           zbdb_internal       node_runtime_info                  NULL         admin    public   SELECT          NO
test           zbdb_internal       node_sessions                      NULL         admin    public   SELECT          NO
test           zbdb_internal       node_statement_statistics          NULL         admin    public   SELECT          NO
test           zbdb_internal       partition_views                    NULL         admin    public   SELECT          NO
test           zbdb_internal       partitions                         NULL         admin    public   SELECT          NO
test           zbdb_internal       predefined_comments                NULL         admin    public   SELECT          NO
test           zbdb_internal       ranges                             NULL         admin    public   SELECT          NO
test           zbdb_internal       ranges_no_leases                   NULL         admin    public   SELECT          NO
test           zbdb_internal       savepoint_status                   NULL         admin    public   SELECT          NO
test           zbdb_internal       schema_changes                     NULL         admin    public   SELECT          NO
test           zbdb_internal       session_trace                      NULL         admin    public   SELECT          NO
test           zbdb_internal       session_variables                  NULL         admin    public   SELECT          NO
test           zbdb_internal       table_columns                      NULL         admin    public   SELECT          NO
test           zbdb_internal       table_indexes                      NULL         admin    public   SELECT          NO
test           zbdb_internal       table_row_statistics               NULL         admin    public   SELECT          NO
test           zbdb_internal       tables                             NULL         admin    public   SELECT          NO
test           zbdb_internal       zones                              NULL         admin    public   SELECT          NO

statement error pgcode 42P01 relation "a.t" does not exist
SHOW GRANTS ON a.t

statement error pgcode 42P01 relation "t" does not exist
SHOW GRANTS ON t

statement ok
SET DATABASE = a

statement error pgcode 42P01 relation "t" does not exist
SHOW GRANTS ON t

statement error pgcode 42P01 relation "a.t" does not exist
GRANT ALL ON a.t TO readwrite

statement ok
CREATE TABLE t (id INT PRIMARY KEY)

query TTTTTTTT colnames
SHOW GRANTS ON t
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
a              public       t           NULL         admin    admin    DELETE          YES
a              public       t           NULL         admin    admin    DROP            YES
a              public       t           NULL         admin    admin    INSERT          YES
a              public       t           NULL         admin    admin    REFERENCES      YES
a              public       t           NULL         admin    admin    SELECT          YES
a              public       t           NULL         admin    admin    TRIGGER         YES
a              public       t           NULL         admin    admin    UPDATE          YES
a              public       t           NULL         admin    root     DELETE          YES
a              public       t           NULL         admin    root     DROP            YES
a              public       t           NULL         admin    root     INSERT          YES
a              public       t           NULL         admin    root     REFERENCES      YES
a              public       t           NULL         admin    root     SELECT          YES
a              public       t           NULL         admin    root     TRIGGER         YES
a              public       t           NULL         admin    root     UPDATE          YES

query TTTTTTTT colnames
SHOW GRANTS ON a.t
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
a              public       t           NULL         admin    admin    DELETE          YES
a              public       t           NULL         admin    admin    DROP            YES
a              public       t           NULL         admin    admin    INSERT          YES
a              public       t           NULL         admin    admin    REFERENCES      YES
a              public       t           NULL         admin    admin    SELECT          YES
a              public       t           NULL         admin    admin    TRIGGER         YES
a              public       t           NULL         admin    admin    UPDATE          YES
a              public       t           NULL         admin    root     DELETE          YES
a              public       t           NULL         admin    root     DROP            YES
a              public       t           NULL         admin    root     INSERT          YES
a              public       t           NULL         admin    root     REFERENCES      YES
a              public       t           NULL         admin    root     SELECT          YES
a              public       t           NULL         admin    root     TRIGGER         YES
a              public       t           NULL         admin    root     UPDATE          YES

statement ok
INSERT INTO system.users VALUES('test-user','');

statement ok
GRANT ALL ON t TO readwrite, "test-user"

query TTTTTTTT
SHOW GRANTS ON t
----
a  public  t  NULL  admin  admin      DELETE      YES
a  public  t  NULL  admin  admin      DROP        YES
a  public  t  NULL  admin  admin      INSERT      YES
a  public  t  NULL  admin  admin      REFERENCES  YES
a  public  t  NULL  admin  admin      SELECT      YES
a  public  t  NULL  admin  admin      TRIGGER     YES
a  public  t  NULL  admin  admin      UPDATE      YES
a  public  t  NULL  admin  root       DELETE      YES
a  public  t  NULL  admin  root       DROP        YES
a  public  t  NULL  admin  root       INSERT      YES
a  public  t  NULL  admin  root       REFERENCES  YES
a  public  t  NULL  admin  root       SELECT      YES
a  public  t  NULL  admin  root       TRIGGER     YES
a  public  t  NULL  admin  root       UPDATE      YES
a  public  t  NULL  root   readwrite  DELETE      NO
a  public  t  NULL  root   readwrite  DROP        NO
a  public  t  NULL  root   readwrite  INSERT      NO
a  public  t  NULL  root   readwrite  REFERENCES  NO
a  public  t  NULL  root   readwrite  SELECT      NO
a  public  t  NULL  root   readwrite  TRIGGER     NO
a  public  t  NULL  root   readwrite  UPDATE      NO
a  public  t  NULL  root   test-user  DELETE      NO
a  public  t  NULL  root   test-user  DROP        NO
a  public  t  NULL  root   test-user  INSERT      NO
a  public  t  NULL  root   test-user  REFERENCES  NO
a  public  t  NULL  root   test-user  SELECT      NO
a  public  t  NULL  root   test-user  TRIGGER     NO
a  public  t  NULL  root   test-user  UPDATE      NO

query TTTTTTTT
SHOW GRANTS ON t FOR readwrite, "test-user"
----
a  public  t  NULL  root  readwrite  DELETE      NO
a  public  t  NULL  root  readwrite  DROP        NO
a  public  t  NULL  root  readwrite  INSERT      NO
a  public  t  NULL  root  readwrite  REFERENCES  NO
a  public  t  NULL  root  readwrite  SELECT      NO
a  public  t  NULL  root  readwrite  TRIGGER     NO
a  public  t  NULL  root  readwrite  UPDATE      NO
a  public  t  NULL  root  test-user  DELETE      NO
a  public  t  NULL  root  test-user  DROP        NO
a  public  t  NULL  root  test-user  INSERT      NO
a  public  t  NULL  root  test-user  REFERENCES  NO
a  public  t  NULL  root  test-user  SELECT      NO
a  public  t  NULL  root  test-user  TRIGGER     NO
a  public  t  NULL  root  test-user  UPDATE      NO

statement ok
REVOKE INSERT,DELETE ON t FROM "test-user",readwrite

query TTTTTTTT
SHOW GRANTS ON t
----
a  public  t  NULL  admin  admin      DELETE      YES
a  public  t  NULL  admin  admin      DROP        YES
a  public  t  NULL  admin  admin      INSERT      YES
a  public  t  NULL  admin  admin      REFERENCES  YES
a  public  t  NULL  admin  admin      SELECT      YES
a  public  t  NULL  admin  admin      TRIGGER     YES
a  public  t  NULL  admin  admin      UPDATE      YES
a  public  t  NULL  admin  root       DELETE      YES
a  public  t  NULL  admin  root       DROP        YES
a  public  t  NULL  admin  root       INSERT      YES
a  public  t  NULL  admin  root       REFERENCES  YES
a  public  t  NULL  admin  root       SELECT      YES
a  public  t  NULL  admin  root       TRIGGER     YES
a  public  t  NULL  admin  root       UPDATE      YES
a  public  t  NULL  root   readwrite  DROP        NO
a  public  t  NULL  root   readwrite  REFERENCES  NO
a  public  t  NULL  root   readwrite  SELECT      NO
a  public  t  NULL  root   readwrite  TRIGGER     NO
a  public  t  NULL  root   readwrite  UPDATE      NO
a  public  t  NULL  root   test-user  DROP        NO
a  public  t  NULL  root   test-user  REFERENCES  NO
a  public  t  NULL  root   test-user  SELECT      NO
a  public  t  NULL  root   test-user  TRIGGER     NO
a  public  t  NULL  root   test-user  UPDATE      NO

query TTTTTTTT
SHOW GRANTS ON t FOR readwrite, "test-user"
----
a  public  t  NULL  root  readwrite  DROP        NO
a  public  t  NULL  root  readwrite  REFERENCES  NO
a  public  t  NULL  root  readwrite  SELECT      NO
a  public  t  NULL  root  readwrite  TRIGGER     NO
a  public  t  NULL  root  readwrite  UPDATE      NO
a  public  t  NULL  root  test-user  DROP        NO
a  public  t  NULL  root  test-user  REFERENCES  NO
a  public  t  NULL  root  test-user  SELECT      NO
a  public  t  NULL  root  test-user  TRIGGER     NO
a  public  t  NULL  root  test-user  UPDATE      NO

statement ok
REVOKE SELECT ON t FROM "test-user"

query TTTTTTTT
SHOW GRANTS ON t
----
a  public  t  NULL  admin  admin      DELETE      YES
a  public  t  NULL  admin  admin      DROP        YES
a  public  t  NULL  admin  admin      INSERT      YES
a  public  t  NULL  admin  admin      REFERENCES  YES
a  public  t  NULL  admin  admin      SELECT      YES
a  public  t  NULL  admin  admin      TRIGGER     YES
a  public  t  NULL  admin  admin      UPDATE      YES
a  public  t  NULL  admin  root       DELETE      YES
a  public  t  NULL  admin  root       DROP        YES
a  public  t  NULL  admin  root       INSERT      YES
a  public  t  NULL  admin  root       REFERENCES  YES
a  public  t  NULL  admin  root       SELECT      YES
a  public  t  NULL  admin  root       TRIGGER     YES
a  public  t  NULL  admin  root       UPDATE      YES
a  public  t  NULL  root   readwrite  DROP        NO
a  public  t  NULL  root   readwrite  REFERENCES  NO
a  public  t  NULL  root   readwrite  SELECT      NO
a  public  t  NULL  root   readwrite  TRIGGER     NO
a  public  t  NULL  root   readwrite  UPDATE      NO
a  public  t  NULL  root   test-user  DROP        NO
a  public  t  NULL  root   test-user  REFERENCES  NO
a  public  t  NULL  root   test-user  TRIGGER     NO
a  public  t  NULL  root   test-user  UPDATE      NO

query TTTTTTTT
SHOW GRANTS ON t FOR readwrite, "test-user"
----
a  public  t  NULL  root  readwrite  DROP        NO
a  public  t  NULL  root  readwrite  REFERENCES  NO
a  public  t  NULL  root  readwrite  SELECT      NO
a  public  t  NULL  root  readwrite  TRIGGER     NO
a  public  t  NULL  root  readwrite  UPDATE      NO
a  public  t  NULL  root  test-user  DROP        NO
a  public  t  NULL  root  test-user  REFERENCES  NO
a  public  t  NULL  root  test-user  TRIGGER     NO
a  public  t  NULL  root  test-user  UPDATE      NO

statement ok
REVOKE ALL ON t FROM readwrite,"test-user"

query TTTTTTTT
SHOW GRANTS ON t
----
a  public  t  NULL  admin  admin  DELETE      YES
a  public  t  NULL  admin  admin  DROP        YES
a  public  t  NULL  admin  admin  INSERT      YES
a  public  t  NULL  admin  admin  REFERENCES  YES
a  public  t  NULL  admin  admin  SELECT      YES
a  public  t  NULL  admin  admin  TRIGGER     YES
a  public  t  NULL  admin  admin  UPDATE      YES
a  public  t  NULL  admin  root   DELETE      YES
a  public  t  NULL  admin  root   DROP        YES
a  public  t  NULL  admin  root   INSERT      YES
a  public  t  NULL  admin  root   REFERENCES  YES
a  public  t  NULL  admin  root   SELECT      YES
a  public  t  NULL  admin  root   TRIGGER     YES
a  public  t  NULL  admin  root   UPDATE      YES

query TTTTTTTT
SHOW GRANTS ON t FOR readwrite, "test-user"
----

# The same as above, but on a view

statement ok
CREATE VIEW v as SELECT id FROM t

query TTTTTTTT colnames
SHOW GRANTS ON VIEW v
----
database_name  schema_name  view_name  column_name  grantor  grantee  privilege_type  grantable
a              public       v          NULL         admin    admin    DELETE          YES
a              public       v          NULL         admin    admin    DROP            YES
a              public       v          NULL         admin    admin    INSERT          YES
a              public       v          NULL         admin    admin    REFERENCES      YES
a              public       v          NULL         admin    admin    SELECT          YES
a              public       v          NULL         admin    admin    TRIGGER         YES
a              public       v          NULL         admin    admin    UPDATE          YES
a              public       v          NULL         admin    root     DELETE          YES
a              public       v          NULL         admin    root     DROP            YES
a              public       v          NULL         admin    root     INSERT          YES
a              public       v          NULL         admin    root     REFERENCES      YES
a              public       v          NULL         admin    root     SELECT          YES
a              public       v          NULL         admin    root     TRIGGER         YES
a              public       v          NULL         admin    root     UPDATE          YES

query TTTTTTTT colnames
SHOW GRANTS ON VIEW a.v
----
database_name  schema_name  view_name  column_name  grantor  grantee  privilege_type  grantable
a              public       v          NULL         admin    admin    DELETE          YES
a              public       v          NULL         admin    admin    DROP            YES
a              public       v          NULL         admin    admin    INSERT          YES
a              public       v          NULL         admin    admin    REFERENCES      YES
a              public       v          NULL         admin    admin    SELECT          YES
a              public       v          NULL         admin    admin    TRIGGER         YES
a              public       v          NULL         admin    admin    UPDATE          YES
a              public       v          NULL         admin    root     DELETE          YES
a              public       v          NULL         admin    root     DROP            YES
a              public       v          NULL         admin    root     INSERT          YES
a              public       v          NULL         admin    root     REFERENCES      YES
a              public       v          NULL         admin    root     SELECT          YES
a              public       v          NULL         admin    root     TRIGGER         YES
a              public       v          NULL         admin    root     UPDATE          YES

statement ok
GRANT ALL ON VIEW v TO readwrite, "test-user"

query TTTTTTTT
SHOW GRANTS ON VIEW v
----
a  public  v  NULL  admin  admin      DELETE      YES
a  public  v  NULL  admin  admin      DROP        YES
a  public  v  NULL  admin  admin      INSERT      YES
a  public  v  NULL  admin  admin      REFERENCES  YES
a  public  v  NULL  admin  admin      SELECT      YES
a  public  v  NULL  admin  admin      TRIGGER     YES
a  public  v  NULL  admin  admin      UPDATE      YES
a  public  v  NULL  admin  root       DELETE      YES
a  public  v  NULL  admin  root       DROP        YES
a  public  v  NULL  admin  root       INSERT      YES
a  public  v  NULL  admin  root       REFERENCES  YES
a  public  v  NULL  admin  root       SELECT      YES
a  public  v  NULL  admin  root       TRIGGER     YES
a  public  v  NULL  admin  root       UPDATE      YES
a  public  v  NULL  root   readwrite  DELETE      NO
a  public  v  NULL  root   readwrite  DROP        NO
a  public  v  NULL  root   readwrite  INSERT      NO
a  public  v  NULL  root   readwrite  REFERENCES  NO
a  public  v  NULL  root   readwrite  SELECT      NO
a  public  v  NULL  root   readwrite  TRIGGER     NO
a  public  v  NULL  root   readwrite  UPDATE      NO
a  public  v  NULL  root   test-user  DELETE      NO
a  public  v  NULL  root   test-user  DROP        NO
a  public  v  NULL  root   test-user  INSERT      NO
a  public  v  NULL  root   test-user  REFERENCES  NO
a  public  v  NULL  root   test-user  SELECT      NO
a  public  v  NULL  root   test-user  TRIGGER     NO
a  public  v  NULL  root   test-user  UPDATE      NO

query TTTTTTTT
SHOW GRANTS ON VIEW v FOR readwrite, "test-user"
----
a  public  v  NULL  root  readwrite  DELETE      NO
a  public  v  NULL  root  readwrite  DROP        NO
a  public  v  NULL  root  readwrite  INSERT      NO
a  public  v  NULL  root  readwrite  REFERENCES  NO
a  public  v  NULL  root  readwrite  SELECT      NO
a  public  v  NULL  root  readwrite  TRIGGER     NO
a  public  v  NULL  root  readwrite  UPDATE      NO
a  public  v  NULL  root  test-user  DELETE      NO
a  public  v  NULL  root  test-user  DROP        NO
a  public  v  NULL  root  test-user  INSERT      NO
a  public  v  NULL  root  test-user  REFERENCES  NO
a  public  v  NULL  root  test-user  SELECT      NO
a  public  v  NULL  root  test-user  TRIGGER     NO
a  public  v  NULL  root  test-user  UPDATE      NO

statement ok
REVOKE INSERT,DELETE ON VIEW v FROM "test-user",readwrite

query TTTTTTTT
SHOW GRANTS ON VIEW v
----
a  public  v  NULL  admin  admin      DELETE      YES
a  public  v  NULL  admin  admin      DROP        YES
a  public  v  NULL  admin  admin      INSERT      YES
a  public  v  NULL  admin  admin      REFERENCES  YES
a  public  v  NULL  admin  admin      SELECT      YES
a  public  v  NULL  admin  admin      TRIGGER     YES
a  public  v  NULL  admin  admin      UPDATE      YES
a  public  v  NULL  admin  root       DELETE      YES
a  public  v  NULL  admin  root       DROP        YES
a  public  v  NULL  admin  root       INSERT      YES
a  public  v  NULL  admin  root       REFERENCES  YES
a  public  v  NULL  admin  root       SELECT      YES
a  public  v  NULL  admin  root       TRIGGER     YES
a  public  v  NULL  admin  root       UPDATE      YES
a  public  v  NULL  root   readwrite  DROP        NO
a  public  v  NULL  root   readwrite  REFERENCES  NO
a  public  v  NULL  root   readwrite  SELECT      NO
a  public  v  NULL  root   readwrite  TRIGGER     NO
a  public  v  NULL  root   readwrite  UPDATE      NO
a  public  v  NULL  root   test-user  DROP        NO
a  public  v  NULL  root   test-user  REFERENCES  NO
a  public  v  NULL  root   test-user  SELECT      NO
a  public  v  NULL  root   test-user  TRIGGER     NO
a  public  v  NULL  root   test-user  UPDATE      NO

query TTTTTTTT
SHOW GRANTS ON VIEW v FOR readwrite, "test-user"
----
a  public  v  NULL  root  readwrite  DROP        NO
a  public  v  NULL  root  readwrite  REFERENCES  NO
a  public  v  NULL  root  readwrite  SELECT      NO
a  public  v  NULL  root  readwrite  TRIGGER     NO
a  public  v  NULL  root  readwrite  UPDATE      NO
a  public  v  NULL  root  test-user  DROP        NO
a  public  v  NULL  root  test-user  REFERENCES  NO
a  public  v  NULL  root  test-user  SELECT      NO
a  public  v  NULL  root  test-user  TRIGGER     NO
a  public  v  NULL  root  test-user  UPDATE      NO

statement ok
REVOKE SELECT ON VIEW v FROM "test-user"

query TTTTTTTT
SHOW GRANTS ON VIEW v
----
a  public  v  NULL  admin  admin      DELETE      YES
a  public  v  NULL  admin  admin      DROP        YES
a  public  v  NULL  admin  admin      INSERT      YES
a  public  v  NULL  admin  admin      REFERENCES  YES
a  public  v  NULL  admin  admin      SELECT      YES
a  public  v  NULL  admin  admin      TRIGGER     YES
a  public  v  NULL  admin  admin      UPDATE      YES
a  public  v  NULL  admin  root       DELETE      YES
a  public  v  NULL  admin  root       DROP        YES
a  public  v  NULL  admin  root       INSERT      YES
a  public  v  NULL  admin  root       REFERENCES  YES
a  public  v  NULL  admin  root       SELECT      YES
a  public  v  NULL  admin  root       TRIGGER     YES
a  public  v  NULL  admin  root       UPDATE      YES
a  public  v  NULL  root   readwrite  DROP        NO
a  public  v  NULL  root   readwrite  REFERENCES  NO
a  public  v  NULL  root   readwrite  SELECT      NO
a  public  v  NULL  root   readwrite  TRIGGER     NO
a  public  v  NULL  root   readwrite  UPDATE      NO
a  public  v  NULL  root   test-user  DROP        NO
a  public  v  NULL  root   test-user  REFERENCES  NO
a  public  v  NULL  root   test-user  TRIGGER     NO
a  public  v  NULL  root   test-user  UPDATE      NO

query TTTTTTTT
SHOW GRANTS ON VIEW v FOR readwrite, "test-user"
----
a  public  v  NULL  root  readwrite  DROP        NO
a  public  v  NULL  root  readwrite  REFERENCES  NO
a  public  v  NULL  root  readwrite  SELECT      NO
a  public  v  NULL  root  readwrite  TRIGGER     NO
a  public  v  NULL  root  readwrite  UPDATE      NO
a  public  v  NULL  root  test-user  DROP        NO
a  public  v  NULL  root  test-user  REFERENCES  NO
a  public  v  NULL  root  test-user  TRIGGER     NO
a  public  v  NULL  root  test-user  UPDATE      NO

query TTTTTTTT
SHOW GRANTS FOR readwrite, "test-user"
----
a  NULL                NULL                               NULL  root   public     USAGE       NO
a  NULL                NULL                               NULL  root   readwrite  CREATE      NO
a  NULL                NULL                               NULL  root   readwrite  DROP        NO
a  NULL                NULL                               NULL  root   readwrite  USAGE       NO
a  information_schema  NULL                               NULL  root   public     USAGE       NO
a  information_schema  NULL                               NULL  root   readwrite  CREATE      NO
a  information_schema  NULL                               NULL  root   readwrite  DROP        NO
a  information_schema  NULL                               NULL  root   readwrite  USAGE       NO
a  information_schema  administrable_role_authorizations  NULL  admin  public     SELECT      NO
a  information_schema  applicable_roles                   NULL  admin  public     SELECT      NO
a  information_schema  check_constraints                  NULL  admin  public     SELECT      NO
a  information_schema  column_privileges                  NULL  admin  public     SELECT      NO
a  information_schema  columns                            NULL  admin  public     SELECT      NO
a  information_schema  constraint_column_usage            NULL  admin  public     SELECT      NO
a  information_schema  database_privileges                NULL  admin  public     SELECT      NO
a  information_schema  enabled_roles                      NULL  admin  public     SELECT      NO
a  information_schema  functions                          NULL  admin  public     SELECT      NO
a  information_schema  index_partition                    NULL  admin  public     SELECT      NO
a  information_schema  key_column_usage                   NULL  admin  public     SELECT      NO
a  information_schema  parameters                         NULL  admin  public     SELECT      NO
a  information_schema  referential_constraints            NULL  admin  public     SELECT      NO
a  information_schema  role_table_grants                  NULL  admin  public     SELECT      NO
a  information_schema  routines                           NULL  admin  public     SELECT      NO
a  information_schema  schema_privileges                  NULL  admin  public     SELECT      NO
a  information_schema  schemata                           NULL  admin  public     SELECT      NO
a  information_schema  sequences                          NULL  admin  public     SELECT      NO
a  information_schema  statistics                         NULL  admin  public     SELECT      NO
a  information_schema  table_constraints                  NULL  admin  public     SELECT      NO
a  information_schema  table_privileges                   NULL  admin  public     SELECT      NO
a  information_schema  tables                             NULL  admin  public     SELECT      NO
a  information_schema  trigger_privileges                 NULL  admin  public     SELECT      NO
a  information_schema  user_privileges                    NULL  admin  public     SELECT      NO
a  information_schema  views                              NULL  admin  public     SELECT      NO
a  pg_catalog          NULL                               NULL  root   public     USAGE       NO
a  pg_catalog          NULL                               NULL  root   readwrite  CREATE      NO
a  pg_catalog          NULL                               NULL  root   readwrite  DROP        NO
a  pg_catalog          NULL                               NULL  root   readwrite  USAGE       NO
a  pg_catalog          pg_am                              NULL  admin  public     SELECT      NO
a  pg_catalog          pg_attrdef                         NULL  admin  public     SELECT      NO
a  pg_catalog          pg_attribute                       NULL  admin  public     SELECT      NO
a  pg_catalog          pg_auth_members                    NULL  admin  public     SELECT      NO
a  pg_catalog          pg_class                           NULL  admin  public     SELECT      NO
a  pg_catalog          pg_collation                       NULL  admin  public     SELECT      NO
a  pg_catalog          pg_constraint                      NULL  admin  public     SELECT      NO
a  pg_catalog          pg_database                        NULL  admin  public     SELECT      NO
a  pg_catalog          pg_depend                          NULL  admin  public     SELECT      NO
a  pg_catalog          pg_description                     NULL  admin  public     SELECT      NO
a  pg_catalog          pg_enum                            NULL  admin  public     SELECT      NO
a  pg_catalog          pg_extension                       NULL  admin  public     SELECT      NO
a  pg_catalog          pg_foreign_data_wrapper            NULL  admin  public     SELECT      NO
a  pg_catalog          pg_foreign_server                  NULL  admin  public     SELECT      NO
a  pg_catalog          pg_foreign_table                   NULL  admin  public     SELECT      NO
a  pg_catalog          pg_index                           NULL  admin  public     SELECT      NO
a  pg_catalog          pg_indexes                         NULL  admin  public     SELECT      NO
a  pg_catalog          pg_inherits                        NULL  admin  public     SELECT      NO
a  pg_catalog          pg_language                        NULL  admin  public     SELECT      NO
a  pg_catalog          pg_namespace                       NULL  admin  public     SELECT      NO
a  pg_catalog          pg_nodestatus                      NULL  admin  public     SELECT      NO
a  pg_catalog          pg_operator                        NULL  admin  public     SELECT      NO
a  pg_catalog          pg_proc                            NULL  admin  public     SELECT      NO
a  pg_catalog          pg_range                           NULL  admin  public     SELECT      NO
a  pg_catalog          pg_rewrite                         NULL  admin  public     SELECT      NO
a  pg_catalog          pg_roles                           NULL  admin  public     SELECT      NO
a  pg_catalog          pg_seclabel                        NULL  admin  public     SELECT      NO
a  pg_catalog          pg_sequence                        NULL  admin  public     SELECT      NO
a  pg_catalog          pg_settings                        NULL  admin  public     SELECT      NO
a  pg_catalog          pg_shdescription                   NULL  admin  public     SELECT      NO
a  pg_catalog          pg_shseclabel                      NULL  admin  public     SELECT      NO
a  pg_catalog          pg_stat_activity                   NULL  admin  public     SELECT      NO
a  pg_catalog          pg_tables                          NULL  admin  public     SELECT      NO
a  pg_catalog          pg_tablespace                      NULL  admin  public     SELECT      NO
a  pg_catalog          pg_trigger                         NULL  admin  public     SELECT      NO
a  pg_catalog          pg_type                            NULL  admin  public     SELECT      NO
a  pg_catalog          pg_user                            NULL  admin  public     SELECT      NO
a  pg_catalog          pg_user_mapping                    NULL  admin  public     SELECT      NO
a  pg_catalog          pg_views                           NULL  admin  public     SELECT      NO
a  public              NULL                               NULL  root   public     USAGE       NO
a  public              v                                  NULL  root   readwrite  DROP        NO
a  public              v                                  NULL  root   readwrite  REFERENCES  NO
a  public              v                                  NULL  root   readwrite  SELECT      NO
a  public              v                                  NULL  root   readwrite  TRIGGER     NO
a  public              v                                  NULL  root   readwrite  UPDATE      NO
a  public              v                                  NULL  root   test-user  DROP        NO
a  public              v                                  NULL  root   test-user  REFERENCES  NO
a  public              v                                  NULL  root   test-user  TRIGGER     NO
a  public              v                                  NULL  root   test-user  UPDATE      NO
a  zbdb_internal       NULL                               NULL  root   public     USAGE       NO
a  zbdb_internal       NULL                               NULL  root   readwrite  CREATE      NO
a  zbdb_internal       NULL                               NULL  root   readwrite  DROP        NO
a  zbdb_internal       NULL                               NULL  root   readwrite  USAGE       NO
a  zbdb_internal       backward_dependencies              NULL  admin  public     SELECT      NO
a  zbdb_internal       builtin_functions                  NULL  admin  public     SELECT      NO
a  zbdb_internal       cluster_queries                    NULL  admin  public     SELECT      NO
a  zbdb_internal       cluster_sessions                   NULL  admin  public     SELECT      NO
a  zbdb_internal       cluster_settings                   NULL  admin  public     SELECT      NO
a  zbdb_internal       create_statements                  NULL  admin  public     SELECT      NO
a  zbdb_internal       databases                          NULL  admin  public     SELECT      NO
a  zbdb_internal       feature_usage                      NULL  admin  public     SELECT      NO
a  zbdb_internal       forward_dependencies               NULL  admin  public     SELECT      NO
a  zbdb_internal       function_privileges                NULL  admin  public     SELECT      NO
a  zbdb_internal       gossip_alerts                      NULL  admin  public     SELECT      NO
a  zbdb_internal       gossip_liveness                    NULL  admin  public     SELECT      NO
a  zbdb_internal       gossip_network                     NULL  admin  public     SELECT      NO
a  zbdb_internal       gossip_nodes                       NULL  admin  public     SELECT      NO
a  zbdb_internal       index_columns                      NULL  admin  public     SELECT      NO
a  zbdb_internal       jobs                               NULL  admin  public     SELECT      NO
a  zbdb_internal       kv_node_status                     NULL  admin  public     SELECT      NO
a  zbdb_internal       kv_store_status                    NULL  admin  public     SELECT      NO
a  zbdb_internal       leases                             NULL  admin  public     SELECT      NO
a  zbdb_internal       node_build_info                    NULL  admin  public     SELECT      NO
a  zbdb_internal       node_metrics                       NULL  admin  public     SELECT      NO
a  zbdb_internal       node_queries                       NULL  admin  public     SELECT      NO
a  zbdb_internal       node_runtime_info                  NULL  admin  public     SELECT      NO
a  zbdb_internal       node_sessions                      NULL  admin  public     SELECT      NO
a  zbdb_internal       node_statement_statistics          NULL  admin  public     SELECT      NO
a  zbdb_internal       partition_views                    NULL  admin  public     SELECT      NO
a  zbdb_internal       partitions                         NULL  admin  public     SELECT      NO
a  zbdb_internal       predefined_comments                NULL  admin  public     SELECT      NO
a  zbdb_internal       ranges                             NULL  admin  public     SELECT      NO
a  zbdb_internal       ranges_no_leases                   NULL  admin  public     SELECT      NO
a  zbdb_internal       savepoint_status                   NULL  admin  public     SELECT      NO
a  zbdb_internal       schema_changes                     NULL  admin  public     SELECT      NO
a  zbdb_internal       session_trace                      NULL  admin  public     SELECT      NO
a  zbdb_internal       session_variables                  NULL  admin  public     SELECT      NO
a  zbdb_internal       table_columns                      NULL  admin  public     SELECT      NO
a  zbdb_internal       table_indexes                      NULL  admin  public     SELECT      NO
a  zbdb_internal       table_row_statistics               NULL  admin  public     SELECT      NO
a  zbdb_internal       tables                             NULL  admin  public     SELECT      NO
a  zbdb_internal       zones                              NULL  admin  public     SELECT      NO

statement ok
REVOKE ALL ON VIEW v FROM readwrite,"test-user"

query TTTTTTTT
SHOW GRANTS ON VIEW v
----
a  public  v  NULL  admin  admin  DELETE      YES
a  public  v  NULL  admin  admin  DROP        YES
a  public  v  NULL  admin  admin  INSERT      YES
a  public  v  NULL  admin  admin  REFERENCES  YES
a  public  v  NULL  admin  admin  SELECT      YES
a  public  v  NULL  admin  admin  TRIGGER     YES
a  public  v  NULL  admin  admin  UPDATE      YES
a  public  v  NULL  admin  root   DELETE      YES
a  public  v  NULL  admin  root   DROP        YES
a  public  v  NULL  admin  root   INSERT      YES
a  public  v  NULL  admin  root   REFERENCES  YES
a  public  v  NULL  admin  root   SELECT      YES
a  public  v  NULL  admin  root   TRIGGER     YES
a  public  v  NULL  admin  root   UPDATE      YES

query TTTTTTTT
SHOW GRANTS ON VIEW v FOR readwrite, "test-user"
----

query TTTTTTTT
SHOW GRANTS FOR readwrite, "test-user"
----
a  NULL                NULL                               NULL  root   public     USAGE   NO
a  NULL                NULL                               NULL  root   readwrite  CREATE  NO
a  NULL                NULL                               NULL  root   readwrite  DROP    NO
a  NULL                NULL                               NULL  root   readwrite  USAGE   NO
a  information_schema  NULL                               NULL  root   public     USAGE   NO
a  information_schema  NULL                               NULL  root   readwrite  CREATE  NO
a  information_schema  NULL                               NULL  root   readwrite  DROP    NO
a  information_schema  NULL                               NULL  root   readwrite  USAGE   NO
a  information_schema  administrable_role_authorizations  NULL  admin  public     SELECT  NO
a  information_schema  applicable_roles                   NULL  admin  public     SELECT  NO
a  information_schema  check_constraints                  NULL  admin  public     SELECT  NO
a  information_schema  column_privileges                  NULL  admin  public     SELECT  NO
a  information_schema  columns                            NULL  admin  public     SELECT  NO
a  information_schema  constraint_column_usage            NULL  admin  public     SELECT  NO
a  information_schema  database_privileges                NULL  admin  public     SELECT  NO
a  information_schema  enabled_roles                      NULL  admin  public     SELECT  NO
a  information_schema  functions                          NULL  admin  public     SELECT  NO
a  information_schema  index_partition                    NULL  admin  public     SELECT  NO
a  information_schema  key_column_usage                   NULL  admin  public     SELECT  NO
a  information_schema  parameters                         NULL  admin  public     SELECT  NO
a  information_schema  referential_constraints            NULL  admin  public     SELECT  NO
a  information_schema  role_table_grants                  NULL  admin  public     SELECT  NO
a  information_schema  routines                           NULL  admin  public     SELECT  NO
a  information_schema  schema_privileges                  NULL  admin  public     SELECT  NO
a  information_schema  schemata                           NULL  admin  public     SELECT  NO
a  information_schema  sequences                          NULL  admin  public     SELECT  NO
a  information_schema  statistics                         NULL  admin  public     SELECT  NO
a  information_schema  table_constraints                  NULL  admin  public     SELECT  NO
a  information_schema  table_privileges                   NULL  admin  public     SELECT  NO
a  information_schema  tables                             NULL  admin  public     SELECT  NO
a  information_schema  trigger_privileges                 NULL  admin  public     SELECT  NO
a  information_schema  user_privileges                    NULL  admin  public     SELECT  NO
a  information_schema  views                              NULL  admin  public     SELECT  NO
a  pg_catalog          NULL                               NULL  root   public     USAGE   NO
a  pg_catalog          NULL                               NULL  root   readwrite  CREATE  NO
a  pg_catalog          NULL                               NULL  root   readwrite  DROP    NO
a  pg_catalog          NULL                               NULL  root   readwrite  USAGE   NO
a  pg_catalog          pg_am                              NULL  admin  public     SELECT  NO
a  pg_catalog          pg_attrdef                         NULL  admin  public     SELECT  NO
a  pg_catalog          pg_attribute                       NULL  admin  public     SELECT  NO
a  pg_catalog          pg_auth_members                    NULL  admin  public     SELECT  NO
a  pg_catalog          pg_class                           NULL  admin  public     SELECT  NO
a  pg_catalog          pg_collation                       NULL  admin  public     SELECT  NO
a  pg_catalog          pg_constraint                      NULL  admin  public     SELECT  NO
a  pg_catalog          pg_database                        NULL  admin  public     SELECT  NO
a  pg_catalog          pg_depend                          NULL  admin  public     SELECT  NO
a  pg_catalog          pg_description                     NULL  admin  public     SELECT  NO
a  pg_catalog          pg_enum                            NULL  admin  public     SELECT  NO
a  pg_catalog          pg_extension                       NULL  admin  public     SELECT  NO
a  pg_catalog          pg_foreign_data_wrapper            NULL  admin  public     SELECT  NO
a  pg_catalog          pg_foreign_server                  NULL  admin  public     SELECT  NO
a  pg_catalog          pg_foreign_table                   NULL  admin  public     SELECT  NO
a  pg_catalog          pg_index                           NULL  admin  public     SELECT  NO
a  pg_catalog          pg_indexes                         NULL  admin  public     SELECT  NO
a  pg_catalog          pg_inherits                        NULL  admin  public     SELECT  NO
a  pg_catalog          pg_language                        NULL  admin  public     SELECT  NO
a  pg_catalog          pg_namespace                       NULL  admin  public     SELECT  NO
a  pg_catalog          pg_nodestatus                      NULL  admin  public     SELECT  NO
a  pg_catalog          pg_operator                        NULL  admin  public     SELECT  NO
a  pg_catalog          pg_proc                            NULL  admin  public     SELECT  NO
a  pg_catalog          pg_range                           NULL  admin  public     SELECT  NO
a  pg_catalog          pg_rewrite                         NULL  admin  public     SELECT  NO
a  pg_catalog          pg_roles                           NULL  admin  public     SELECT  NO
a  pg_catalog          pg_seclabel                        NULL  admin  public     SELECT  NO
a  pg_catalog          pg_sequence                        NULL  admin  public     SELECT  NO
a  pg_catalog          pg_settings                        NULL  admin  public     SELECT  NO
a  pg_catalog          pg_shdescription                   NULL  admin  public     SELECT  NO
a  pg_catalog          pg_shseclabel                      NULL  admin  public     SELECT  NO
a  pg_catalog          pg_stat_activity                   NULL  admin  public     SELECT  NO
a  pg_catalog          pg_tables                          NULL  admin  public     SELECT  NO
a  pg_catalog          pg_tablespace                      NULL  admin  public     SELECT  NO
a  pg_catalog          pg_trigger                         NULL  admin  public     SELECT  NO
a  pg_catalog          pg_type                            NULL  admin  public     SELECT  NO
a  pg_catalog          pg_user                            NULL  admin  public     SELECT  NO
a  pg_catalog          pg_user_mapping                    NULL  admin  public     SELECT  NO
a  pg_catalog          pg_views                           NULL  admin  public     SELECT  NO
a  public              NULL                               NULL  root   public     USAGE   NO
a  zbdb_internal       NULL                               NULL  root   public     USAGE   NO
a  zbdb_internal       NULL                               NULL  root   readwrite  CREATE  NO
a  zbdb_internal       NULL                               NULL  root   readwrite  DROP    NO
a  zbdb_internal       NULL                               NULL  root   readwrite  USAGE   NO
a  zbdb_internal       backward_dependencies              NULL  admin  public     SELECT  NO
a  zbdb_internal       builtin_functions                  NULL  admin  public     SELECT  NO
a  zbdb_internal       cluster_queries                    NULL  admin  public     SELECT  NO
a  zbdb_internal       cluster_sessions                   NULL  admin  public     SELECT  NO
a  zbdb_internal       cluster_settings                   NULL  admin  public     SELECT  NO
a  zbdb_internal       create_statements                  NULL  admin  public     SELECT  NO
a  zbdb_internal       databases                          NULL  admin  public     SELECT  NO
a  zbdb_internal       feature_usage                      NULL  admin  public     SELECT  NO
a  zbdb_internal       forward_dependencies               NULL  admin  public     SELECT  NO
a  zbdb_internal       function_privileges                NULL  admin  public     SELECT  NO
a  zbdb_internal       gossip_alerts                      NULL  admin  public     SELECT  NO
a  zbdb_internal       gossip_liveness                    NULL  admin  public     SELECT  NO
a  zbdb_internal       gossip_network                     NULL  admin  public     SELECT  NO
a  zbdb_internal       gossip_nodes                       NULL  admin  public     SELECT  NO
a  zbdb_internal       index_columns                      NULL  admin  public     SELECT  NO
a  zbdb_internal       jobs                               NULL  admin  public     SELECT  NO
a  zbdb_internal       kv_node_status                     NULL  admin  public     SELECT  NO
a  zbdb_internal       kv_store_status                    NULL  admin  public     SELECT  NO
a  zbdb_internal       leases                             NULL  admin  public     SELECT  NO
a  zbdb_internal       node_build_info                    NULL  admin  public     SELECT  NO
a  zbdb_internal       node_metrics                       NULL  admin  public     SELECT  NO
a  zbdb_internal       node_queries                       NULL  admin  public     SELECT  NO
a  zbdb_internal       node_runtime_info                  NULL  admin  public     SELECT  NO
a  zbdb_internal       node_sessions                      NULL  admin  public     SELECT  NO
a  zbdb_internal       node_statement_statistics          NULL  admin  public     SELECT  NO
a  zbdb_internal       partition_views                    NULL  admin  public     SELECT  NO
a  zbdb_internal       partitions                         NULL  admin  public     SELECT  NO
a  zbdb_internal       predefined_comments                NULL  admin  public     SELECT  NO
a  zbdb_internal       ranges                             NULL  admin  public     SELECT  NO
a  zbdb_internal       ranges_no_leases                   NULL  admin  public     SELECT  NO
a  zbdb_internal       savepoint_status                   NULL  admin  public     SELECT  NO
a  zbdb_internal       schema_changes                     NULL  admin  public     SELECT  NO
a  zbdb_internal       session_trace                      NULL  admin  public     SELECT  NO
a  zbdb_internal       session_variables                  NULL  admin  public     SELECT  NO
a  zbdb_internal       table_columns                      NULL  admin  public     SELECT  NO
a  zbdb_internal       table_indexes                      NULL  admin  public     SELECT  NO
a  zbdb_internal       table_row_statistics               NULL  admin  public     SELECT  NO
a  zbdb_internal       tables                             NULL  admin  public     SELECT  NO
a  zbdb_internal       zones                              NULL  admin  public     SELECT  NO


# Verify that the DB privileges have not changed.
query TTTTT colnames
SHOW GRANTS ON DATABASE a
----
database_name  grantor  grantee    privilege_type  grantable
a              admin    admin      CREATE          YES
a              admin    admin      DROP            YES
a              admin    admin      USAGE           YES
a              admin    root       CREATE          YES
a              admin    root       DROP            YES
a              admin    root       USAGE           YES
a              root     public     USAGE           NO
a              root     readwrite  CREATE          NO
a              root     readwrite  DROP            NO
a              root     readwrite  USAGE           NO


# Errors due to invalid targets.
statement ok
SET DATABASE = ""

statement error pq: syntax error at or near "@"
GRANT ALL ON a.t@xyz TO readwrite

statement error pq: "\*" does not match any valid database or schema
GRANT ALL ON * TO readwrite

statement error pgcode 42P01 relation "a.tt" does not exist
GRANT ALL ON a.t, a.tt TO readwrite

# '*' doesn't work for databases.
statement error pq: syntax error at or near "*"
GRANT ALL ON DATABASE * TO readwrite

statement ok
CREATE DATABASE b

statement ok
CREATE TABLE b.t (id INT PRIMARY KEY)

statement ok
CREATE TABLE b.t2 (id INT PRIMARY KEY)

statement ok
CREATE DATABASE c

statement ok
CREATE TABLE c.t (id INT PRIMARY KEY)

# `*` works after you've set a database
statement ok
SET DATABASE = "b"

statement error pq: user or role vanilli does not exist
GRANT ALL ON * TO Vanilli

statement ok
CREATE USER Vanilli

statement ok
GRANT ALL ON * TO Vanilli

query TTTTTTTT colnames
SHOW GRANTS ON *
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
b              public       t           NULL         admin    admin    DELETE          YES
b              public       t           NULL         admin    admin    DROP            YES
b              public       t           NULL         admin    admin    INSERT          YES
b              public       t           NULL         admin    admin    REFERENCES      YES
b              public       t           NULL         admin    admin    SELECT          YES
b              public       t           NULL         admin    admin    TRIGGER         YES
b              public       t           NULL         admin    admin    UPDATE          YES
b              public       t           NULL         admin    root     DELETE          YES
b              public       t           NULL         admin    root     DROP            YES
b              public       t           NULL         admin    root     INSERT          YES
b              public       t           NULL         admin    root     REFERENCES      YES
b              public       t           NULL         admin    root     SELECT          YES
b              public       t           NULL         admin    root     TRIGGER         YES
b              public       t           NULL         admin    root     UPDATE          YES
b              public       t           NULL         root     vanilli  DELETE          NO
b              public       t           NULL         root     vanilli  DROP            NO
b              public       t           NULL         root     vanilli  INSERT          NO
b              public       t           NULL         root     vanilli  REFERENCES      NO
b              public       t           NULL         root     vanilli  SELECT          NO
b              public       t           NULL         root     vanilli  TRIGGER         NO
b              public       t           NULL         root     vanilli  UPDATE          NO
b              public       t2          NULL         admin    admin    DELETE          YES
b              public       t2          NULL         admin    admin    DROP            YES
b              public       t2          NULL         admin    admin    INSERT          YES
b              public       t2          NULL         admin    admin    REFERENCES      YES
b              public       t2          NULL         admin    admin    SELECT          YES
b              public       t2          NULL         admin    admin    TRIGGER         YES
b              public       t2          NULL         admin    admin    UPDATE          YES
b              public       t2          NULL         admin    root     DELETE          YES
b              public       t2          NULL         admin    root     DROP            YES
b              public       t2          NULL         admin    root     INSERT          YES
b              public       t2          NULL         admin    root     REFERENCES      YES
b              public       t2          NULL         admin    root     SELECT          YES
b              public       t2          NULL         admin    root     TRIGGER         YES
b              public       t2          NULL         admin    root     UPDATE          YES
b              public       t2          NULL         root     vanilli  DELETE          NO
b              public       t2          NULL         root     vanilli  DROP            NO
b              public       t2          NULL         root     vanilli  INSERT          NO
b              public       t2          NULL         root     vanilli  REFERENCES      NO
b              public       t2          NULL         root     vanilli  SELECT          NO
b              public       t2          NULL         root     vanilli  TRIGGER         NO
b              public       t2          NULL         root     vanilli  UPDATE          NO

# Multiple targets.
statement ok
CREATE USER Millie

statement ok
GRANT ALL ON c.*, b.t TO Millie

query TTTTTTTT colnames
SHOW GRANTS ON b.*
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
b              public       t           NULL         admin    admin    DELETE          YES
b              public       t           NULL         admin    admin    DROP            YES
b              public       t           NULL         admin    admin    INSERT          YES
b              public       t           NULL         admin    admin    REFERENCES      YES
b              public       t           NULL         admin    admin    SELECT          YES
b              public       t           NULL         admin    admin    TRIGGER         YES
b              public       t           NULL         admin    admin    UPDATE          YES
b              public       t           NULL         admin    root     DELETE          YES
b              public       t           NULL         admin    root     DROP            YES
b              public       t           NULL         admin    root     INSERT          YES
b              public       t           NULL         admin    root     REFERENCES      YES
b              public       t           NULL         admin    root     SELECT          YES
b              public       t           NULL         admin    root     TRIGGER         YES
b              public       t           NULL         admin    root     UPDATE          YES
b              public       t           NULL         root     millie   DELETE          NO
b              public       t           NULL         root     millie   DROP            NO
b              public       t           NULL         root     millie   INSERT          NO
b              public       t           NULL         root     millie   REFERENCES      NO
b              public       t           NULL         root     millie   SELECT          NO
b              public       t           NULL         root     millie   TRIGGER         NO
b              public       t           NULL         root     millie   UPDATE          NO
b              public       t           NULL         root     vanilli  DELETE          NO
b              public       t           NULL         root     vanilli  DROP            NO
b              public       t           NULL         root     vanilli  INSERT          NO
b              public       t           NULL         root     vanilli  REFERENCES      NO
b              public       t           NULL         root     vanilli  SELECT          NO
b              public       t           NULL         root     vanilli  TRIGGER         NO
b              public       t           NULL         root     vanilli  UPDATE          NO
b              public       t2          NULL         admin    admin    DELETE          YES
b              public       t2          NULL         admin    admin    DROP            YES
b              public       t2          NULL         admin    admin    INSERT          YES
b              public       t2          NULL         admin    admin    REFERENCES      YES
b              public       t2          NULL         admin    admin    SELECT          YES
b              public       t2          NULL         admin    admin    TRIGGER         YES
b              public       t2          NULL         admin    admin    UPDATE          YES
b              public       t2          NULL         admin    root     DELETE          YES
b              public       t2          NULL         admin    root     DROP            YES
b              public       t2          NULL         admin    root     INSERT          YES
b              public       t2          NULL         admin    root     REFERENCES      YES
b              public       t2          NULL         admin    root     SELECT          YES
b              public       t2          NULL         admin    root     TRIGGER         YES
b              public       t2          NULL         admin    root     UPDATE          YES
b              public       t2          NULL         root     vanilli  DELETE          NO
b              public       t2          NULL         root     vanilli  DROP            NO
b              public       t2          NULL         root     vanilli  INSERT          NO
b              public       t2          NULL         root     vanilli  REFERENCES      NO
b              public       t2          NULL         root     vanilli  SELECT          NO
b              public       t2          NULL         root     vanilli  TRIGGER         NO
b              public       t2          NULL         root     vanilli  UPDATE          NO

query TTTTTTTT colnames
SHOW GRANTS ON a.*, b.*
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
a              public       t           NULL         admin    admin    DELETE          YES
a              public       t           NULL         admin    admin    DROP            YES
a              public       t           NULL         admin    admin    INSERT          YES
a              public       t           NULL         admin    admin    REFERENCES      YES
a              public       t           NULL         admin    admin    SELECT          YES
a              public       t           NULL         admin    admin    TRIGGER         YES
a              public       t           NULL         admin    admin    UPDATE          YES
a              public       t           NULL         admin    root     DELETE          YES
a              public       t           NULL         admin    root     DROP            YES
a              public       t           NULL         admin    root     INSERT          YES
a              public       t           NULL         admin    root     REFERENCES      YES
a              public       t           NULL         admin    root     SELECT          YES
a              public       t           NULL         admin    root     TRIGGER         YES
a              public       t           NULL         admin    root     UPDATE          YES
b              public       t           NULL         admin    admin    DELETE          YES
b              public       t           NULL         admin    admin    DROP            YES
b              public       t           NULL         admin    admin    INSERT          YES
b              public       t           NULL         admin    admin    REFERENCES      YES
b              public       t           NULL         admin    admin    SELECT          YES
b              public       t           NULL         admin    admin    TRIGGER         YES
b              public       t           NULL         admin    admin    UPDATE          YES
b              public       t           NULL         admin    root     DELETE          YES
b              public       t           NULL         admin    root     DROP            YES
b              public       t           NULL         admin    root     INSERT          YES
b              public       t           NULL         admin    root     REFERENCES      YES
b              public       t           NULL         admin    root     SELECT          YES
b              public       t           NULL         admin    root     TRIGGER         YES
b              public       t           NULL         admin    root     UPDATE          YES
b              public       t           NULL         root     millie   DELETE          NO
b              public       t           NULL         root     millie   DROP            NO
b              public       t           NULL         root     millie   INSERT          NO
b              public       t           NULL         root     millie   REFERENCES      NO
b              public       t           NULL         root     millie   SELECT          NO
b              public       t           NULL         root     millie   TRIGGER         NO
b              public       t           NULL         root     millie   UPDATE          NO
b              public       t           NULL         root     vanilli  DELETE          NO
b              public       t           NULL         root     vanilli  DROP            NO
b              public       t           NULL         root     vanilli  INSERT          NO
b              public       t           NULL         root     vanilli  REFERENCES      NO
b              public       t           NULL         root     vanilli  SELECT          NO
b              public       t           NULL         root     vanilli  TRIGGER         NO
b              public       t           NULL         root     vanilli  UPDATE          NO
b              public       t2          NULL         admin    admin    DELETE          YES
b              public       t2          NULL         admin    admin    DROP            YES
b              public       t2          NULL         admin    admin    INSERT          YES
b              public       t2          NULL         admin    admin    REFERENCES      YES
b              public       t2          NULL         admin    admin    SELECT          YES
b              public       t2          NULL         admin    admin    TRIGGER         YES
b              public       t2          NULL         admin    admin    UPDATE          YES
b              public       t2          NULL         admin    root     DELETE          YES
b              public       t2          NULL         admin    root     DROP            YES
b              public       t2          NULL         admin    root     INSERT          YES
b              public       t2          NULL         admin    root     REFERENCES      YES
b              public       t2          NULL         admin    root     SELECT          YES
b              public       t2          NULL         admin    root     TRIGGER         YES
b              public       t2          NULL         admin    root     UPDATE          YES
b              public       t2          NULL         root     vanilli  DELETE          NO
b              public       t2          NULL         root     vanilli  DROP            NO
b              public       t2          NULL         root     vanilli  INSERT          NO
b              public       t2          NULL         root     vanilli  REFERENCES      NO
b              public       t2          NULL         root     vanilli  SELECT          NO
b              public       t2          NULL         root     vanilli  TRIGGER         NO
b              public       t2          NULL         root     vanilli  UPDATE          NO

query TTTTTTTT colnames
SHOW GRANTS ON c.t
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
c              public       t           NULL         admin    admin    DELETE          YES
c              public       t           NULL         admin    admin    DROP            YES
c              public       t           NULL         admin    admin    INSERT          YES
c              public       t           NULL         admin    admin    REFERENCES      YES
c              public       t           NULL         admin    admin    SELECT          YES
c              public       t           NULL         admin    admin    TRIGGER         YES
c              public       t           NULL         admin    admin    UPDATE          YES
c              public       t           NULL         admin    root     DELETE          YES
c              public       t           NULL         admin    root     DROP            YES
c              public       t           NULL         admin    root     INSERT          YES
c              public       t           NULL         admin    root     REFERENCES      YES
c              public       t           NULL         admin    root     SELECT          YES
c              public       t           NULL         admin    root     TRIGGER         YES
c              public       t           NULL         admin    root     UPDATE          YES
c              public       t           NULL         root     millie   DELETE          NO
c              public       t           NULL         root     millie   DROP            NO
c              public       t           NULL         root     millie   INSERT          NO
c              public       t           NULL         root     millie   REFERENCES      NO
c              public       t           NULL         root     millie   SELECT          NO
c              public       t           NULL         root     millie   TRIGGER         NO
c              public       t           NULL         root     millie   UPDATE          NO

statement ok
REVOKE ALL ON *, c.* FROM Vanilli

query TTTTTTTT colnames
SHOW GRANTS ON b.*
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
b              public       t           NULL         admin    admin    DELETE          YES
b              public       t           NULL         admin    admin    DROP            YES
b              public       t           NULL         admin    admin    INSERT          YES
b              public       t           NULL         admin    admin    REFERENCES      YES
b              public       t           NULL         admin    admin    SELECT          YES
b              public       t           NULL         admin    admin    TRIGGER         YES
b              public       t           NULL         admin    admin    UPDATE          YES
b              public       t           NULL         admin    root     DELETE          YES
b              public       t           NULL         admin    root     DROP            YES
b              public       t           NULL         admin    root     INSERT          YES
b              public       t           NULL         admin    root     REFERENCES      YES
b              public       t           NULL         admin    root     SELECT          YES
b              public       t           NULL         admin    root     TRIGGER         YES
b              public       t           NULL         admin    root     UPDATE          YES
b              public       t           NULL         root     millie   DELETE          NO
b              public       t           NULL         root     millie   DROP            NO
b              public       t           NULL         root     millie   INSERT          NO
b              public       t           NULL         root     millie   REFERENCES      NO
b              public       t           NULL         root     millie   SELECT          NO
b              public       t           NULL         root     millie   TRIGGER         NO
b              public       t           NULL         root     millie   UPDATE          NO
b              public       t2          NULL         admin    admin    DELETE          YES
b              public       t2          NULL         admin    admin    DROP            YES
b              public       t2          NULL         admin    admin    INSERT          YES
b              public       t2          NULL         admin    admin    REFERENCES      YES
b              public       t2          NULL         admin    admin    SELECT          YES
b              public       t2          NULL         admin    admin    TRIGGER         YES
b              public       t2          NULL         admin    admin    UPDATE          YES
b              public       t2          NULL         admin    root     DELETE          YES
b              public       t2          NULL         admin    root     DROP            YES
b              public       t2          NULL         admin    root     INSERT          YES
b              public       t2          NULL         admin    root     REFERENCES      YES
b              public       t2          NULL         admin    root     SELECT          YES
b              public       t2          NULL         admin    root     TRIGGER         YES
b              public       t2          NULL         admin    root     UPDATE          YES

statement ok
CREATE DATABASE empty

query TTTTTTTT colnames
SHOW GRANTS ON empty.*
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable

query TTTTTTTT colnames
SHOW GRANTS ON empty.*, b.*
----
database_name  schema_name  table_name  column_name  grantor  grantee  privilege_type  grantable
b              public       t           NULL         admin    admin    DELETE          YES
b              public       t           NULL         admin    admin    DROP            YES
b              public       t           NULL         admin    admin    INSERT          YES
b              public       t           NULL         admin    admin    REFERENCES      YES
b              public       t           NULL         admin    admin    SELECT          YES
b              public       t           NULL         admin    admin    TRIGGER         YES
b              public       t           NULL         admin    admin    UPDATE          YES
b              public       t           NULL         admin    root     DELETE          YES
b              public       t           NULL         admin    root     DROP            YES
b              public       t           NULL         admin    root     INSERT          YES
b              public       t           NULL         admin    root     REFERENCES      YES
b              public       t           NULL         admin    root     SELECT          YES
b              public       t           NULL         admin    root     TRIGGER         YES
b              public       t           NULL         admin    root     UPDATE          YES
b              public       t           NULL         root     millie   DELETE          NO
b              public       t           NULL         root     millie   DROP            NO
b              public       t           NULL         root     millie   INSERT          NO
b              public       t           NULL         root     millie   REFERENCES      NO
b              public       t           NULL         root     millie   SELECT          NO
b              public       t           NULL         root     millie   TRIGGER         NO
b              public       t           NULL         root     millie   UPDATE          NO
b              public       t2          NULL         admin    admin    DELETE          YES
b              public       t2          NULL         admin    admin    DROP            YES
b              public       t2          NULL         admin    admin    INSERT          YES
b              public       t2          NULL         admin    admin    REFERENCES      YES
b              public       t2          NULL         admin    admin    SELECT          YES
b              public       t2          NULL         admin    admin    TRIGGER         YES
b              public       t2          NULL         admin    admin    UPDATE          YES
b              public       t2          NULL         admin    root     DELETE          YES
b              public       t2          NULL         admin    root     DROP            YES
b              public       t2          NULL         admin    root     INSERT          YES
b              public       t2          NULL         admin    root     REFERENCES      YES
b              public       t2          NULL         admin    root     SELECT          YES
b              public       t2          NULL         admin    root     TRIGGER         YES
b              public       t2          NULL         admin    root     UPDATE          YES
